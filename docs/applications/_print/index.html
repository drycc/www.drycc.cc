<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="/docs/applications/">
<link rel="alternate" type="application/rss&#43;xml" href="/docs/applications/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Applications | Drycc</title>
<meta name="description" content="A simple and scalable cloud platform for all developer needs.">
<meta property="og:url" content="/docs/applications/">
  <meta property="og:site_name" content="Drycc">
  <meta property="og:title" content="Applications">
  <meta property="og:description" content="A simple and scalable cloud platform for all developer needs.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">

  <meta itemprop="name" content="Applications">
  <meta itemprop="description" content="A simple and scalable cloud platform for all developer needs.">
  <meta itemprop="dateModified" content="2024-05-06T13:43:29+08:00">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Applications">
  <meta name="twitter:description" content="A simple and scalable cloud platform for all developer needs.">
<link rel="preload" href="/scss/main.min.c5f3972ecd14552b62d50499cdf962964cffcef39104da44781bfe2d89334f3c.css" as="style" integrity="sha256-xfOXLs0UVSti1QSZzflilkz/zvORBNpEeBv&#43;LYkzTzw=" crossorigin="anonymous">
<link href="/scss/main.min.c5f3972ecd14552b62d50499cdf962964cffcef39104da44781bfe2d89334f3c.css" rel="stylesheet" integrity="sha256-xfOXLs0UVSti1QSZzflilkz/zvORBNpEeBv&#43;LYkzTzw=" crossorigin="anonymous">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>
<script defer
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg width="30" height="30" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><circle id="Oval" stroke="#ff2f57" fill="#ff2f57" cx="3" cy="3" r="2"/><circle id="Oval" stroke="#ff2f57" fill="#ff2f57" cx="3" cy="13" r="2"/><circle id="Oval" stroke="#ff2f57" fill="#ff2f57" cx="13" cy="13" r="2"/><circle id="Oval" stroke="#ff2f57" fill="#ff2f57" cx="13" cy="13" r="2"/><circle id="Oval" stroke="#ff2f57" fill="#ff2f57" cx="13" cy="3" r="2"/><rect id="Rectangle" stroke="#3fb1e5" fill="#3fb1e5" x="6.5" y="6.5" width="3" height="3"/><polygon id="Triangle" stroke="#38bb4c" fill="#38bb4c" stroke-linejoin="round" points="8 11 10 15 6 15"/><polygon id="Triangle" stroke="#38bb4c" fill="#38bb4c" stroke-linejoin="round" transform="translate(3.000000, 8.000000) rotate(90.000000) translate(-3.000000, -8.000000)" points="3 6 5 10 1 10"/><polygon id="Triangle" stroke="#38bb4c" fill="#38bb4c" stroke-linejoin="round" transform="translate(8.000000, 3.000000) rotate(180.000000) translate(-8.000000, -3.000000)" points="8 1 10 5 6 5"/><polygon id="Triangle" stroke="#38bb4c" fill="#38bb4c" stroke-linejoin="round" transform="translate(13.000000, 8.000000) rotate(270.000000) translate(-13.000000, -8.000000)" points="13 6 15 10 11 10"/></g></svg></span><span class="navbar-brand__name">Drycc</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/about/"><span>About Us</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="/docs/"><span>Docs</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/blog/"><span>Blog</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/community/"><span>Community</span></a>
      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.f289c1e4acebc2095c6ea9f5b314646a.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/applications/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Applications</h1>
<div class="lead">A simple and scalable cloud platform for all developer needs.</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-39cba0eed348438976fb73c0202d32e7">Deploying an Application</a></li>


    
  
    
    
	
<li>2: <a href="#pg-e96b3fec23ec2a2036cb1009c6e0f7b9">Using Buildpacks</a></li>


    
  
    
    
	
<li>3: <a href="#pg-bad1760884a3d1568108fc1c87043baf">Using Dockerfiles</a></li>


    
  
    
    
	
<li>4: <a href="#pg-911ae34b8caae3b502b7d403c569c269">Using Docker Images</a></li>


    
  
    
    
	
<li>5: <a href="#pg-3513e6172bfa8a431b2e8b6aadf643c9">Managing Application Processes</a></li>


    
  
    
    
	
<li>6: <a href="#pg-f7fe2ebef366052e0d8bfb14e3e044f5">Configuring an Application</a></li>


    
  
    
    
	
<li>7: <a href="#pg-9db3915fd6ded30b69a25418cc7df8c0">Managing Application Metrics</a></li>


    
  
    
    
	
<li>8: <a href="#pg-8b23c65b4ab7634b1e278d7873029bf6">Managing an Application</a></li>


    
  
    
    
	
<li>9: <a href="#pg-4f70d2fc7490bc1f7a4aba25dd86ea12">Mounting volumes for an Application</a></li>


    
  
    
    
	
<li>10: <a href="#pg-d364e5ac44490f83dacb071ecdaaebb8">About gateway for an Application</a></li>


    
  
    
    
	
<li>11: <a href="#pg-b120b91d31144e14252d09e3351ac63d">Managing resources for an Application</a></li>


    
  
    
    
	
<li>12: <a href="#pg-af7e8c313c7749aeeb64a743cd877d8c">Inter-app Communication</a></li>


    
  
    
    
	
<li>13: <a href="#pg-3d9c4efe910f455454c4946b64225b5f">Resource Limits</a></li>


    
  
    
    
	
<li>14: <a href="#pg-587aac9ca7fb3c0e091c5b73ec65588b">Domains and Routing</a></li>


    
  
    
    
	
<li>15: <a href="#pg-ea3f4f0325f471c26fd2281464da7884">Application SSL Certificates</a></li>


    
  
    
    
	
<li>16: <a href="#pg-25a98ad7024438acf828ac381152307f">Using drycc path</a></li>


    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-39cba0eed348438976fb73c0202d32e7">1 - Deploying an Application</h1>
    <div class="lead">Learn how to deploy the application to drycc.</div>
	<p>An <a href="../reference-guide/terms.md#application">Application</a> is deployed to Drycc using <code>git push</code> or the <code>drycc</code> client.</p>
<h2 id="supported-applications">Supported Applications<a class="td-heading-self-link" href="#supported-applications" aria-label="Heading self-link"></a></h2>
<p>Drycc Workflow can deploy any application or service that can run inside a container.  In order to be scaled
horizontally, applications must follow the <a href="http://12factor.net/">Twelve-Factor App</a> methodology and store any application state in external
backing services.</p>
<p>For example, if your application persists state to the local filesystem &ndash; common with content management systems like
Wordpress and Drupal &ndash; it cannot be scaled horizontally using <code>drycc scale</code>.</p>
<p>Fortunately, most modern applications feature a stateless application tier that can scale horizontally inside Drycc.</p>
<h2 id="login-to-the-controller">Login to the Controller<a class="td-heading-self-link" href="#login-to-the-controller" aria-label="Heading self-link"></a></h2>
<p>!!! important
if you haven&rsquo;t yet, now is a good time to <a href="/docs/users/cli/#installation">install the client</a> and <a href="/docs/users/registration/">register</a>.</p>
<p>Before deploying an application, users must first authenticate against the Drycc <a href="/docs/understanding-workflow/components/#controller">Controller</a>
using the URL supplied by their Drycc administrator.</p>
<pre tabindex="0"><code>$ drycc login http://drycc.example.com
Opening browser to http://drycc.example.com/v2/login/drycc/?key=4ccc81ee2dce4349ad5261ceffe72c71
Waiting for login... .o.Logged in as admin
Configuration file written to /root/.drycc/client.json
</code></pre><p>Or you can login with username and password</p>
<pre tabindex="0"><code>$ drycc login http://drycc.example.com --username=demo --password=demo
Configuration file written to /root/.drycc/client.json
</code></pre><h2 id="select-a-build-process">Select a Build Process<a class="td-heading-self-link" href="#select-a-build-process" aria-label="Heading self-link"></a></h2>
<p>Drycc Workflow supports three different ways of building applications:</p>
<h3 id="buildpacks">Buildpacks<a class="td-heading-self-link" href="#buildpacks" aria-label="Heading self-link"></a></h3>
<p>Cloud Native Buildpacks are useful if you want to follow <a href="https://buildpacks.io/docs/">cnb&rsquo;s docs</a> for building applications.</p>
<p>Learn how to deploy applications <a href="/docs/applications/using-buildpacks/">using Buildpacks</a>.</p>
<h3 id="dockerfiles">Dockerfiles<a class="td-heading-self-link" href="#dockerfiles" aria-label="Heading self-link"></a></h3>
<p>Dockerfiles are a powerful way to define a portable execution environment built on a base OS of your choosing.</p>
<p>Learn how to deploy applications <a href="/docs/applications/using-dockerfiles/">using Dockerfiles</a>.</p>
<h3 id="container-image">Container Image<a class="td-heading-self-link" href="#container-image" aria-label="Heading self-link"></a></h3>
<p>Deploying a Container image onto Drycc allows you to take a Container image from either a public
or a private registry and copy it over bit-for-bit, ensuring that you are running the same
image in development or in your CI pipeline as you are in production.</p>
<p>Learn how to deploy applications <a href="/docs/applications/using-container-images/">using Container images</a>.</p>
<h2 id="tuning-application-settings">Tuning Application Settings<a class="td-heading-self-link" href="#tuning-application-settings" aria-label="Heading self-link"></a></h2>
<p>It is possible to configure a few of the <a href="/docs/applications/managing-app-configuration/">globally tunable</a> settings on per application basis using <code>config:set</code>.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DRYCC_DISABLE_CACHE</td>
<td>if set, this will disable the [imagebuilder cache][] (default: not set)</td>
</tr>
<tr>
<td>DRYCC_DEPLOY_BATCHES</td>
<td>the number of pods to bring up and take down sequentially during a scale (default: number of available nodes)</td>
</tr>
<tr>
<td>DRYCC_DEPLOY_TIMEOUT</td>
<td>deploy timeout in seconds per deploy batch (default: 120)</td>
</tr>
<tr>
<td>IMAGE_PULL_POLICY</td>
<td>the kubernetes [image pull policy][pull-policy] for application images (default: &ldquo;IfNotPresent&rdquo;) (allowed values: &ldquo;Always&rdquo;, &ldquo;IfNotPresent&rdquo;)</td>
</tr>
<tr>
<td>KUBERNETES_DEPLOYMENTS_REVISION_HISTORY_LIMIT</td>
<td>how many <a href="http://kubernetes.io/docs/user-guide/deployments/#revision-history-limit">revisions</a> Kubernetes keeps around of a given Deployment (default: all revisions)</td>
</tr>
<tr>
<td>KUBERNETES_POD_TERMINATION_GRACE_PERIOD_SECONDS</td>
<td>how many seconds kubernetes waits for a pod to finish work after a SIGTERM before sending SIGKILL (default: 30)</td>
</tr>
</tbody>
</table>
<h3 id="deploy-timeout">Deploy Timeout<a class="td-heading-self-link" href="#deploy-timeout" aria-label="Heading self-link"></a></h3>
<p>Deploy timeout in seconds - There are 2 deploy methods, Deployments (see below) and RC (versions prior to 2.4) and this setting affects those a bit differently.</p>
<h4 id="deployments">Deployments<a class="td-heading-self-link" href="#deployments" aria-label="Heading self-link"></a></h4>
<p>Deployments behave a little bit differently from the RC based deployment strategy.</p>
<p>Kubernetes takes care of the entire deploy, doing rolling updates in the background. As a result, there is only an overall deployment timeout instead of a configurable per-batch timeout.</p>
<p>The base timeout is multiplied with <code>DRYCC_DEPLOY_BATCHES</code> to create an overall timeout. This would be 240 (timeout) * 4 (batches) = 960 second overall timeout.</p>
<h4 id="rc-deploy">RC deploy<a class="td-heading-self-link" href="#rc-deploy" aria-label="Heading self-link"></a></h4>
<p>This deploy timeout defines how long to wait for each batch to complete in <code>DRYCC_DEPLOY_BATCHES</code>.</p>
<h4 id="additions-to-the-base-timeout">Additions to the base timeout<a class="td-heading-self-link" href="#additions-to-the-base-timeout" aria-label="Heading self-link"></a></h4>
<p>The base timeout is extended as well with healthchecks using <code>initialDelaySeconds</code> on <code>liveness</code> and <code>readiness</code> where the bigger of those two is applied.
Additionally the timeout system accounts for slow image pulls by adding an additional 10 minutes when it has seen an image pull take over 1 minute. This allows the timeout values to be reasonable without having to account for image pull slowness in the base deploy timeout.</p>
<h3 id="deployments-1">Deployments<a class="td-heading-self-link" href="#deployments-1" aria-label="Heading self-link"></a></h3>
<p>Workflow uses <a href="http://kubernetes.io/docs/user-guide/deployments/">Deployments</a> for deploys. In prior versions <a href="http://kubernetes.io/docs/user-guide/replication-controller/">ReplicationControllers</a> were used with the ability to turn on Deployments via <code>DRYCC_KUBERNETES_DEPLOYMENTS=1</code>.</p>
<p>The advantage of <a href="http://kubernetes.io/docs/user-guide/deployments/">Deployments</a> is that rolling-updates will happen server-side in Kubernetes instead of in Drycc Workflow Controller,
along with a few other Pod management related functionality. This allows a deploy to continue even when the CLI connection is interrupted.</p>
<p>Behind the scenes your application deploy will be built up of a Deployment object per process type,
each having multiple ReplicaSets (one per release) which in turn manage the Pods running your application.</p>
<p>Drycc Workflow will behave the same way with <code>DRYCC_KUBERNETES_DEPLOYMENTS</code> enabled or disabled (only applicable to versions prior to 2.4).
The changes are behind the scenes. Where you will see differences while using the CLI is <code>drycc ps:list</code> will output Pod names differently.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e96b3fec23ec2a2036cb1009c6e0f7b9">2 - Using Buildpacks</h1>
    <div class="lead">An overview of buildpacks, which are responsible for transforming deployed code into a slug, which can then be executed on a container.</div>
	<p>Drycc supports deploying applications via <a href="https://buildpacks.io/">Cloud Native Buildpacks</a>. Cloud Native Buildpacks are useful if you want to follow <a href="https://buildpacks.io/docs/">cnb&rsquo;s docs</a> for building applications.</p>
<h2 id="add-ssh-key">Add SSH Key<a class="td-heading-self-link" href="#add-ssh-key" aria-label="Heading self-link"></a></h2>
<p>For <strong>Buildpack</strong> based application deploys via <code>git push</code>, Drycc Workflow identifies users via SSH keys. SSH keys are pushed to the platform and must be unique to each user.</p>
<ul>
<li>
<p>See <a href="/docs/users/ssh-keys/#generate-an-ssh-key">this document</a> for instructions on how to generate an SSH key.</p>
</li>
<li>
<p>Run <code>drycc keys add</code> to upload your SSH key to Drycc Workflow.</p>
</li>
</ul>
<pre tabindex="0"><code>$ drycc keys add ~/.ssh/id_drycc.pub
Uploading id_drycc.pub to drycc... done
</code></pre><p>Read more about adding/removing SSH Keys <a href="/docs/users/ssh-keys/#adding-and-removing-ssh-keys">here</a>.</p>
<h2 id="prepare-an-application">Prepare an Application<a class="td-heading-self-link" href="#prepare-an-application" aria-label="Heading self-link"></a></h2>
<p>If you do not have an existing application, you can clone an example application that demonstrates the Heroku Buildpack workflow.</p>
<pre><code>$ git clone https://github.com/drycc/example-go.git
$ cd example-go
</code></pre>
<h2 id="create-an-application">Create an Application<a class="td-heading-self-link" href="#create-an-application" aria-label="Heading self-link"></a></h2>
<p>Use <code>drycc create</code> to create an application on the <a href="/docs/understanding-workflow/components/#controller">Controller</a>.</p>
<pre><code>$ drycc create
Creating application... done, created skiing-keypunch
Git remote drycc added
</code></pre>
<h2 id="push-to-deploy">Push to Deploy<a class="td-heading-self-link" href="#push-to-deploy" aria-label="Heading self-link"></a></h2>
<p>Use <code>git push drycc master</code> to deploy your application.</p>
<pre><code>$ git push drycc master
Counting objects: 75, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (48/48), done.
Writing objects: 100% (75/75), 18.28 KiB | 0 bytes/s, done.
Total 75 (delta 30), reused 58 (delta 22)
remote: ---&gt;
Starting build... but first, coffee!
---&gt; Waiting podman running.
---&gt; Process podman started.
---&gt; Waiting caddy running.
---&gt; Process caddy started.
---&gt; Building pack
---&gt; Using builder registry.drycc.cc/drycc/buildpacks:bookworm
Builder 'registry.drycc.cc/drycc/buildpacks:bookworm' is trusted
Pulling image 'registry.drycc.cc/drycc/buildpacks:bookworm'
Resolving &quot;drycc/buildpacks&quot; using unqualified-search registries (/etc/containers/registries.conf)
Trying to pull registry.drycc.cc/drycc/buildpacks:bookworm...
Getting image source signatures
...
---&gt; Skip generate base layer
---&gt; Python Buildpack
---&gt; Downloading and extracting Python 3.10.0
---&gt; Installing requirements with pip
Collecting Django==3.2.8
Downloading Django-3.2.8-py3-none-any.whl (7.9 MB)
Collecting gunicorn==20.1.0
Downloading gunicorn-20.1.0-py3-none-any.whl (79 kB)
Collecting sqlparse&gt;=0.2.2
Downloading sqlparse-0.4.2-py3-none-any.whl (42 kB)
Collecting pytz
Downloading pytz-2021.3-py2.py3-none-any.whl (503 kB)
Collecting asgiref&lt;4,&gt;=3.3.2
Downloading asgiref-3.4.1-py3-none-any.whl (25 kB)
Requirement already satisfied: setuptools&gt;=3.0 in /layers/drycc_python/python/lib/python3.10/site-packages (from gunicorn==20.1.0-&gt;-r requirements.txt (line 2)) (57.5.0)
Installing collected packages: sqlparse, pytz, asgiref, gunicorn, Django
Successfully installed Django-3.2.8 asgiref-3.4.1 gunicorn-20.1.0 pytz-2021.3 sqlparse-0.4.2
---&gt; Generate Launcher
...
Build complete.
Launching App...
...
Done, skiing-keypunch:v2 deployed to Workflow

Use 'drycc open' to view this application in your browser

To learn more, use 'drycc help' or visit https://www.drycc.cc

To ssh://git@drycc.staging-2.drycc.cc:2222/skiing-keypunch.git
 * [new branch]      master -&gt; master

$ curl -s http://skiing-keypunch.example.com
Powered by Drycc
Release v2 on skiing-keypunch-v2-web-02zb9
</code></pre>
<p>Because a Buildpacks-style application is detected, the <code>web</code> process type is automatically scaled to 1 on first deploy.</p>
<p>Use <code>drycc scale web=3</code> to increase <code>web</code> processes to 3, for example. Scaling a
process type directly changes the number of <a href="http://kubernetes.io/v1.1/docs/user-guide/pods.html">pods</a> running that process.</p>
<h2 id="included-buildpacks">Included Buildpacks<a class="td-heading-self-link" href="#included-buildpacks" aria-label="Heading self-link"></a></h2>
<p>For convenience, a number of buildpacks come bundled with Drycc:</p>
<ul>
<li><a href="https://github.com/drycc/pack-images/tree/main/buildpacks/go">Go Buildpack</a></li>
<li><a href="https://github.com/drycc/pack-images/tree/main/buildpacks/java">Java Buildpack</a></li>
<li><a href="https://github.com/drycc/pack-images/tree/main/buildpacks/nodejs">Nodejs Buildpack</a></li>
<li><a href="https://github.com/drycc/pack-images/tree/main/buildpacks/php">PHP Buildpack</a></li>
<li><a href="https://github.com/drycc/pack-images/tree/main/buildpacks/python">Python Buildpack</a></li>
<li><a href="https://github.com/drycc/pack-images/tree/main/buildpacks/ruby">Ruby Buildpack</a></li>
<li><a href="https://github.com/drycc/pack-images/tree/main/buildpacks/rust">Rust Buildpack</a></li>
</ul>
<p>Drycc will cycle through the <code>bin/detect</code> script of each buildpack to match the code you
are pushing.</p>
<p>!!! note
If you&rsquo;re testing against the [Scala Buildpack][], the <a href="/docs/understanding-workflow/components/#builder">Builder</a> requires at least
512MB of free memory to execute the Scala Build Tool.</p>
<h2 id="using-a-custom-buildpack">Using a Custom Buildpack<a class="td-heading-self-link" href="#using-a-custom-buildpack" aria-label="Heading self-link"></a></h2>
<p>To use a custom buildpack, you need create a <code>.pack_builder</code> file in your root path app.</p>
<pre><code>$  tee &gt; .pack-builder &lt;&lt; EOF
   &gt; registry.drycc.cc/drycc/buildpacks:bookworm
   &gt; EOF
</code></pre>
<p>On your next <code>git push</code>, the custom buildpack will be used.</p>
<h2 id="using-private-repositories">Using Private Repositories<a class="td-heading-self-link" href="#using-private-repositories" aria-label="Heading self-link"></a></h2>
<p>To pull code from private repositories, set the <code>SSH_KEY</code> environment variable to a private key
which has access. Use either the path of a private key file or the raw key material:</p>
<pre><code>$ drycc config set SSH_KEY=/home/user/.ssh/id_rsa
$ drycc config set SSH_KEY=&quot;&quot;&quot;-----BEGIN RSA PRIVATE KEY-----
(...)
-----END RSA PRIVATE KEY-----&quot;&quot;&quot;
</code></pre>
<p>For example, to use a custom buildpack hosted at a private GitHub URL, ensure that an SSH public
key exists in your <a href="https://github.com/settings/ssh">GitHub settings</a>. Then set <code>SSH_KEY</code> to the corresponding SSH private key
and set <code>.pack_builder</code> to the builder image:</p>
<pre><code>$  tee &gt; .pack-builder &lt;&lt; EOF
   &gt; registry.drycc.cc/drycc/buildpacks:bookworm
   &gt; EOF
$ git add .buildpack
$ git commit -m &quot;chore(buildpack): modify the pack_builder&quot;
$ git push drycc master
</code></pre>
<h2 id="builder-selector">Builder selector<a class="td-heading-self-link" href="#builder-selector" aria-label="Heading self-link"></a></h2>
<p>Which way to build a project conforms to the following principles:</p>
<ul>
<li>If Dockerfile exists in the project, the stack uses <code>container</code></li>
<li>If Procfile exists in the project, the stack uses <code>buildpack</code></li>
<li>If both exist, <code>container</code> is used by default</li>
<li>You can also set the <code>DRYCC_STACK</code> to <code>container</code> or <code>buildpack</code> determine which stack to use.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-bad1760884a3d1568108fc1c87043baf">3 - Using Dockerfiles</h1>
    <div class="lead">Drycc Container Registry allows you to deploy your Docker-based app to Drycc. Both Common Runtime and Private Spaces are supported.</div>
	<p>Drycc supports deploying applications via Dockerfiles.  A <a href="https://docs.docker.com/reference/builder/">Dockerfile</a> automates the steps for crafting a [Container Image][].
Dockerfiles are incredibly powerful but require some extra work to define your exact application runtime environment.</p>
<h2 id="add-ssh-key">Add SSH Key<a class="td-heading-self-link" href="#add-ssh-key" aria-label="Heading self-link"></a></h2>
<p>For <strong>Dockerfile</strong> based application deploys via <code>git push</code>, Drycc Workflow identifies users via SSH keys. SSH keys are pushed to the platform and must be unique to each user.</p>
<ul>
<li>
<p>See <a href="/docs/users/ssh-keys/#generate-an-ssh-key">this document</a> for instructions on how to generate an SSH key.</p>
</li>
<li>
<p>Run <code>drycc keys add</code> to upload your SSH key to Drycc Workflow.</p>
</li>
</ul>
<pre tabindex="0"><code>$ drycc keys add ~/.ssh/id_drycc.pub
Uploading id_drycc.pub to drycc... done
</code></pre><p>Read more about adding/removing SSH Keys <a href="/docs/users/ssh-keys/#adding-and-removing-ssh-keys">here</a>.</p>
<h2 id="prepare-an-application">Prepare an Application<a class="td-heading-self-link" href="#prepare-an-application" aria-label="Heading self-link"></a></h2>
<p>If you do not have an existing application, you can clone an example application that demonstrates the Dockerfile workflow.</p>
<pre><code>$ git clone https://github.com/drycc/helloworld.git
$ cd helloworld
</code></pre>
<h3 id="dockerfile-requirements">Dockerfile Requirements<a class="td-heading-self-link" href="#dockerfile-requirements" aria-label="Heading self-link"></a></h3>
<p>In order to deploy Dockerfile applications, they must conform to the following requirements:</p>
<ul>
<li>The Dockerfile must use the <code>EXPOSE</code> directive to expose exactly one port.</li>
<li>That port must be listening for an HTTP connection.</li>
<li>The Dockerfile must use the <code>CMD</code> directive to define the default process that will run within the container.</li>
<li>The Container image must contain <a href="https://www.gnu.org/software/bash/">bash</a> to run processes.</li>
</ul>
<p>!!! note
Note that if you are using a private registry of any kind (<code>gcr</code> or other) the application environment must include a <code>$PORT</code> config variable that matches the <code>EXPOSE</code>&rsquo;d port, example: <code>drycc config set PORT=5000</code>. See <a href="/docs/installing-workflow/configuring-registry/#configuring-off-cluster-private-registry">Configuring Registry</a> for more info.</p>
<h2 id="create-an-application">Create an Application<a class="td-heading-self-link" href="#create-an-application" aria-label="Heading self-link"></a></h2>
<p>Use <code>drycc create</code> to create an application on the <a href="/docs/understanding-workflow/components/#controller">Controller</a>.</p>
<pre><code>$ drycc create
Creating application... done, created folksy-offshoot
Git remote drycc added
</code></pre>
<h2 id="push-to-deploy">Push to Deploy<a class="td-heading-self-link" href="#push-to-deploy" aria-label="Heading self-link"></a></h2>
<p>Use <code>git push drycc master</code> to deploy your application.</p>
<pre><code>$ git push drycc master
Counting objects: 13, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (13/13), done.
Writing objects: 100% (13/13), 1.99 KiB | 0 bytes/s, done.
Total 13 (delta 2), reused 0 (delta 0)
-----&gt; Building Docker image
Uploading context 4.096 kB
Uploading context
Step 0 : FROM drycc/base:latest
 ---&gt; 60024338bc63
Step 1 : RUN wget -O /tmp/go1.2.1.linux-amd64.tar.gz -q https://go.googlecode.com/files/go1.2.1.linux-amd64.tar.gz
 ---&gt; Using cache
 ---&gt; cf9ef8c5caa7
Step 2 : RUN tar -C /usr/local -xzf /tmp/go1.2.1.linux-amd64.tar.gz
 ---&gt; Using cache
 ---&gt; 515b1faf3bd8
Step 3 : RUN mkdir -p /go
 ---&gt; Using cache
 ---&gt; ebf4927a00e9
Step 4 : ENV GOPATH /go
 ---&gt; Using cache
 ---&gt; c6a276eded37
Step 5 : ENV PATH /usr/local/go/bin:/go/bin:$PATH
 ---&gt; Using cache
 ---&gt; 2ba6f6c9f108
Step 6 : ADD . /go/src/github.com/drycc/helloworld
 ---&gt; 94ab7f4b977b
Removing intermediate container 171b7d9fdb34
Step 7 : RUN cd /go/src/github.com/drycc/helloworld &amp;&amp; go install -v .
 ---&gt; Running in 0c8fbb2d2812
github.com/drycc/helloworld
 ---&gt; 13b5af931393
Removing intermediate container 0c8fbb2d2812
Step 8 : ENV PORT 80
 ---&gt; Running in 9b07da36a272
 ---&gt; 2dce83167874
Removing intermediate container 9b07da36a272
Step 9 : CMD [&quot;/go/bin/helloworld&quot;]
 ---&gt; Running in f7b215199940
 ---&gt; b1e55ce5195a
Removing intermediate container f7b215199940
Step 10 : EXPOSE 80
 ---&gt; Running in 7eb8ec45dcb0
 ---&gt; ea1a8cc93ca3
Removing intermediate container 7eb8ec45dcb0
Successfully built ea1a8cc93ca3
-----&gt; Pushing image to private registry

       Launching... done, v2

-----&gt; folksy-offshoot deployed to Drycc
       http://folksy-offshoot.local3.dryccapp.com

       To learn more, use `drycc help` or visit https://www.drycc.cc

To ssh://git@local3.dryccapp.com:2222/folksy-offshoot.git
 * [new branch]      master -&gt; master

$ curl -s http://folksy-offshoot.local3.dryccapp.com
Welcome to Drycc!
See the documentation at http://docs.drycc.cc/ for more information.
</code></pre>
<p>Because a Dockerfile application is detected, the <code>web</code> process type is automatically scaled to 1 on first deploy.</p>
<p>Use <code>drycc scale web=3</code> to increase <code>web</code> processes to 3, for example. Scaling a
process type directly changes the number of <a href="../reference-guide/terms.md#container">containers</a>
running that process.</p>
<h2 id="container-build-arguments">Container Build Arguments<a class="td-heading-self-link" href="#container-build-arguments" aria-label="Heading self-link"></a></h2>
<p>As of Workflow v2.13.0, users can inject their application config into the Container image using
<a href="https://docs.docker.com/engine/reference/commandline/build/#set-build-time-variables---build-arg">Container build arguments</a>. To opt into this, users must add a new environment variable
to their application:</p>
<pre tabindex="0"><code>$ drycc config set DRYCC_DOCKER_BUILD_ARGS_ENABLED=1
</code></pre><p>Every environment variable set with <code>drycc config set</code> will then be available for use inside the
user&rsquo;s Dockerfile. For example, if a user runs <code>drycc config set POWERED_BY=Workflow</code>,
the user can utilize that build argument in their Dockerfile:</p>
<pre tabindex="0"><code>ARG POWERED_BY
RUN echo &#34;Powered by $POWERED_BY&#34; &gt; /etc/motd
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-911ae34b8caae3b502b7d403c569c269">4 - Using Docker Images</h1>
    <div class="lead">Deploy an application using a container image stored in your Drycc Container Registry.</div>
	<p>Drycc supports deploying applications via an existing <a href="https://docs.docker.com/introduction/understanding-docker/">Docker Image</a>.
This is useful for integrating Drycc into Docker-based CI/CD pipelines.</p>
<h2 id="prepare-an-application">Prepare an Application<a class="td-heading-self-link" href="#prepare-an-application" aria-label="Heading self-link"></a></h2>
<p>Start by cloning an example application:</p>
<pre><code>$ git clone https://github.com/drycc/example-dockerfile-http.git
$ cd example-dockerfile-http
</code></pre>
<p>Next use your local <code>docker</code> client to build the image and push
it to <a href="https://registry.hub.docker.com/">DockerHub</a>.</p>
<pre><code>$ docker build -t &lt;username&gt;/example-dockerfile-http .
$ docker push &lt;username&gt;/example-dockerfile-http
</code></pre>
<h3 id="docker-image-requirements">Docker Image Requirements<a class="td-heading-self-link" href="#docker-image-requirements" aria-label="Heading self-link"></a></h3>
<p>In order to deploy Docker images, they must conform to the following requirements:</p>
<ul>
<li>The Dockerfile must use the <code>EXPOSE</code> directive to expose exactly one port.</li>
<li>That port must be listening for an HTTP connection.</li>
<li>The Dockerfile must use the <code>CMD</code> directive to define the default process that will run within the container.</li>
<li>The Docker image must contain <a href="https://www.gnu.org/software/bash/">bash</a> to run processes.</li>
</ul>
<p>!!! note
Note that if you are using a private registry of any kind (<code>gcr</code> or other) the application environment must include a <code>$PORT</code> config variable that matches the <code>EXPOSE</code>&rsquo;d port, example: <code>drycc config set PORT=5000</code>. See <a href="/docs/installing-workflow/configuring-registry/#configuring-off-cluster-private-registry">Configuring Registry</a> for more info.</p>
<h2 id="create-an-application">Create an Application<a class="td-heading-self-link" href="#create-an-application" aria-label="Heading self-link"></a></h2>
<p>Use <code>drycc create</code> to create an application on the <a href="/docs/understanding-workflow/components/#controller">controller</a>.</p>
<pre><code>$ mkdir -p /tmp/example-dockerfile-http &amp;&amp; cd /tmp/example-dockerfile-http
$ drycc create example-dockerfile-http --no-remote
Creating application... done, created example-dockerfile-http
</code></pre>
<p>!!! note
For all commands except for <code>drycc create</code>, the <code>drycc</code> client uses the name of the current directory
as the app name if you don&rsquo;t specify it explicitly with <code>--app</code>.</p>
<h2 id="deploy-the-application">Deploy the Application<a class="td-heading-self-link" href="#deploy-the-application" aria-label="Heading self-link"></a></h2>
<p>Use <code>drycc pull</code> to deploy your application from <a href="https://registry.hub.docker.com/">DockerHub</a> or
a public registry.</p>
<pre><code>$ drycc pull &lt;username&gt;/example-dockerfile-http:latest
Creating build...  done, v2

$ curl -s http://example-dockerfile-http.local3.dryccapp.com
Powered by Drycc
</code></pre>
<p>Because you are deploying a Docker image, the <code>web</code> process type is automatically scaled to 1 on first deploy.</p>
<p>Use <code>drycc scale web=3</code> to increase <code>web</code> processes to 3, for example. Scaling a
process type directly changes the number of <a href="../reference-guide/terms.md#container">Containers</a>
running that process.</p>
<h2 id="private-registry">Private Registry<a class="td-heading-self-link" href="#private-registry" aria-label="Heading self-link"></a></h2>
<p>To deploy Docker images from a private registry or from a private repository, use <code>drycc registry</code>
to attach credentials to your application. These credentials are the same as you&rsquo;d use when running
<code>docker login</code> at your private registry.</p>
<p>To deploy private Docker images, take the following steps:</p>
<ul>
<li>Gather the username and password for the registry, such as a <a href="https://docs.quay.io/glossary/robot-accounts.html">Quay.io Robot Account</a> or a <a href="https://cloud.google.com/container-registry/docs/auth#using_a_json_key_file">GCR.io Long Lived Token</a></li>
<li>Run <code>drycc registry set &lt;the-user&gt; &lt;secret&gt; -a &lt;application-name&gt;</code></li>
<li>Now perform <code>drycc pull</code> as normal, against an image in the private registry</li>
</ul>
<p>When using a <a href="https://cloud.google.com/container-registry/docs/auth#using_a_json_key_file">GCR.io Long Lived Token</a>, the JSON blob will have to be compacted first using a
tool like <a href="https://stedolan.github.io/jq/">jq</a> and then used in the password field in <code>drycc registry set</code>. For the username, use
<code>_json_key</code>. For example:</p>
<pre tabindex="0"><code>drycc registry set _json_key &#34;$(cat google_cloud_cred.json | jq -c .)&#34;
</code></pre><p>When using a private registry the docker images are no longer pulled into the Drycc Internal Registry via
the Drycc Workflow Controller but rather is managed by Kubernetes. This will increase security and overall speed,
however the application <code>port</code> information can no longer be discovered. Instead the application <code>port</code> information can be set via
<code>drycc config set PORT=80</code> prior to setting the registry information.</p>
<p>!!! note
Currently <a href="https://gcr.io">GCR.io</a> and <a href="https://aws.amazon.com/ecr/">ECR</a> in short lived auth token mode are not supported.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3513e6172bfa8a431b2e8b6aadf643c9">5 - Managing Application Processes</h1>
    <div class="lead">A Procfile is a list of process types in an app. Each process type declares a command that is executed when a container of that process type is started.</div>
	<p>Drycc Workflow manages your application as a set of processes that can be named, scaled and configured according to their
role. This gives you the flexibility to easily manage the different facets of your application. For example, you may have
web-facing processes that handle HTTP traffic, background worker processes that do async work, and a helper process that
streams from the Twitter API.</p>
<p>By using a Procfile, either checked in to your application or provided via the CLI you can specify the name of the type
and the application command that should run. To spawn other process types, use <code>drycc scale &lt;ptype&gt;=&lt;n&gt;</code> to scale those
types accordingly.</p>
<h2 id="default-process-types">Default Process Types<a class="td-heading-self-link" href="#default-process-types" aria-label="Heading self-link"></a></h2>
<p>In the absence of a Procfile, a single, default process type is assumed for each application.</p>
<p>Applications built using <a href="/docs/applications/using-buildpacks/">Buildpacks</a> via <code>git push</code> implicitly receive a <code>web</code> process type, which starts
the application server. Rails 4, for example, has the following process type:</p>
<pre><code>web: bundle exec rails server -p $PORT
</code></pre>
<p>All applications utilizing <a href="/docs/applications/using-dockerfiles/">Dockerfiles</a> have an implied <code>web</code> process type, which runs the
Dockerfile&rsquo;s <code>CMD</code> directive unmodified:</p>
<pre><code>$ cat Dockerfile
FROM centos:latest
COPY . /app
WORKDIR /app
CMD python -m SimpleHTTPServer 5000
EXPOSE 5000
</code></pre>
<p>For the above Dockerfile-based application, the <code>web</code> process type would run the Container <code>CMD</code> of <code>python -m SimpleHTTPServer 5000</code>.</p>
<p>Applications utilizing <a href="/docs/applications/using-container-images/">remote Container images</a>, a <code>web</code> process type is also implied, and runs the <code>CMD</code>
specified in the Container image.</p>
<p>!!! note
The <code>web</code> process type is special as they’is the default process type that will
receive HTTP traffic from Workflow’s routers. Other process types can be named arbitrarily.</p>
<h2 id="declaring-process-types">Declaring Process Types<a class="td-heading-self-link" href="#declaring-process-types" aria-label="Heading self-link"></a></h2>
<p>If you use <a href="/docs/applications/using-buildpacks/">Buildpack</a> or <a href="/docs/applications/using-dockerfiles/">Dockerfile</a> builds and want to override or specify additional process
types, simply include a file named <code>Procfile</code> in the root of your application&rsquo;s source tree.</p>
<p>The format of a <code>Procfile</code> is one process type per line, with each line containing the command to invoke:</p>
<pre><code>&lt;process type&gt;: &lt;command&gt;
</code></pre>
<p>The syntax is defined as:</p>
<ul>
<li><code>&lt;process type&gt;</code> – a lowercase alphanumeric string, is a name for your command, such as web, worker, urgentworker, clock, etc.</li>
<li><code>&lt;command&gt;</code> – a command line to launch the process, such as <code>rake jobs:work</code>.</li>
</ul>
<p>This example Procfile specifies two types, <code>web</code> and <code>sleeper</code>. The <code>web</code> process launches a web server on port 5000 and
a simple process which sleeps for 900 seconds and exits.</p>
<pre tabindex="0"><code>$ cat Procfile
web: bundle exec ruby web.rb -p ${PORT:-5000}
sleeper: sleep 900
</code></pre><p>If you are using <a href="/docs/applications/using-container-images/">remote Container images</a>, you may define process types by either running <code>drycc pull</code> with a
<code>Procfile</code> in your working directory, or by passing a stringified Procfile to the <code>--procfile</code> CLI option.</p>
<p>For example, passing process types inline:</p>
<pre tabindex="0"><code>$ drycc pull drycc/example-go:latest --procfile=&#34;web: /app/bin/boot&#34;
</code></pre><p>Read a <code>Procfile</code> in another directory:</p>
<pre tabindex="0"><code>$ drycc pull drycc/example-go:latest --procfile=&#34;$(cat deploy/Procfile)&#34;
</code></pre><p>Or via a Procfile located in your current, working directory:</p>
<pre tabindex="0"><code>$ cat Procfile
web: /bin/boot
sleeper: echo &#34;sleeping&#34;; sleep 900


$ drycc pull -a steely-mainsail drycc/example-go
Creating build... done

$ drycc scale sleeper=1 -a steely-mainsail
Scaling processes... but first, coffee!
done in 0s

NAME                                        RELEASE    STATE    PTYPE      READY    RESTARTS     STARTED
steely-mainsail-sleeper-76c45b967c-4qm6w    v3         up       sleeper    1/1      0            2023-12-08T02:25:00UTC
steely-mainsail-web-c4f44c4b4-7p7dh         v3         up       web        1/1      0            2023-12-08T02:25:00UTC
</code></pre><p>!!! note
Only process types of <code>web</code> will be scaled to 1 automatically. If you have additional process types
remember to scale the process counts after creation.</p>
<p>To remove a process type simply scale it to 0:</p>
<pre tabindex="0"><code>$ drycc scale sleeper=0 -a steely-mainsail
Scaling processes... but first, coffee!
done in 3s

NAME                                        RELEASE    STATE    PTYPE      READY    RESTARTS     STARTED
steely-mainsail-web-c4f44c4b4-7p7dh         v3         up       web        1/1      0            2023-12-08T02:25:00UTC
</code></pre><h2 id="scaling-processes">Scaling Processes<a class="td-heading-self-link" href="#scaling-processes" aria-label="Heading self-link"></a></h2>
<p>Applications deployed on Drycc Workflow scale out via the <a href="https://devcenter.heroku.com/articles/process-model">process model</a>. Use <code>drycc scale</code> to control the number of
<a href="../reference-guide/terms.md#container">containers</a> that power your app.</p>
<pre tabindex="0"><code>$ drycc scale web=5 -a iciest-waggoner
Scaling processes... but first, coffee!
done in 3s

NAME                                        RELEASE    STATE    PTYPE      READY    RESTARTS     STARTED
iciest-waggoner-web-c4f44c4b4-7p7dh         v3         up       web        1/1      0            2023-12-08T02:25:00UTC
iciest-waggoner-web-c4f44c4b4-8p7dh         v3         up       web        1/1      0            2023-12-08T02:25:00UTC
iciest-waggoner-web-c4f44c4b4-9p7dh         v3         up       web        1/1      0            2023-12-08T02:25:00UTC
iciest-waggoner-web-c4f44c4b4-1p7dh         v3         up       web        1/1      0            2023-12-08T02:25:00UTC
iciest-waggoner-web-c4f44c4b4-2p7dh         v3         up       web        1/1      0            2023-12-08T02:25:00UTC
</code></pre><p>If you have multiple process types for your application you may scale the process count for each type separately. For
example, this allows you to manage web process independently from background workers. For more information on process
types see our documentation for <a href="/docs/applications/managing-app-processes/">Managing App Processes</a>.</p>
<p>In this example, we are scaling the process type <code>web</code> to 5 but leaving the process type <code>background</code> with one worker.</p>
<pre tabindex="0"><code>$ drycc scale web=5
Scaling processes... but first, coffee!
done in 4s

NAME                                                RELEASE    STATE    PTYPE      READY    RESTARTS     STARTED
scenic-icehouse-web-3291896318-7lord                v3         up       web        1/1      0            2023-12-08T02:25:00UTC
scenic-icehouse-web-3291896318-jn957                v3         up       web        1/1      0            2023-12-08T02:25:00UTC
scenic-icehouse-web-3291896318-rsekj                v3         up       web        1/1      0            2023-12-08T02:25:00UTC
scenic-icehouse-web-3291896318-vwhnh                v3         up       web        1/1      0            2023-12-08T02:25:00UTC
scenic-icehouse-web-3291896318-vokg7                v3         up       web        1/1      0            2023-12-08T02:25:00UTC
scenic-icehouse-web-3291896318-vokg7                v3         up       web        1/1      0            2023-12-08T02:25:00UTC
scenic-icehouse-background-3291896318-yf8kh         v3         up       web        1/1      0            2023-12-08T02:25:00UTC
</code></pre><p>Scaling a process down, by reducing the process count, sends a <code>TERM</code> signal to the processes, followed by a <code>SIGKILL</code>
if they have not exited within 30 seconds. Depending on your application, scaling down may interrupt long-running HTTP
client connections.</p>
<p>For example, scaling from 5 processes to 3:</p>
<pre tabindex="0"><code>$ drycc scale web=3
Scaling processes... but first, coffee!
done in 1s

NAME                                                RELEASE    STATE    PTYPE     READY    RESTARTS     STARTED
scenic-icehouse-web-3291896318-vwhnh                v2         up       web       1/1      0            2023-12-08T02:25:00UTC
scenic-icehouse-web-3291896318-vokg7                v2         up       web       1/1      0            2023-12-08T02:25:00UTC
scenic-icehouse-web-3291896318-vokg9                v2         up       web       1/1      0            2023-12-08T02:25:00UTC
scenic-icehouse-background-3291896318-yf8kh         v2         up       web       1/1      0            2023-12-08T02:25:00UTC
</code></pre><h2 id="autoscale">Autoscale<a class="td-heading-self-link" href="#autoscale" aria-label="Heading self-link"></a></h2>
<p>Autoscale allows adding a minimum and maximum number of pods on a per process type basis. This is accomplished by specifying a target CPU usage across all available pods.</p>
<p>This feature is built on top of <a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/">Horizontal Pod Autoscaling</a> in Kubernetes or <a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/">HPA</a> for short.</p>
<p>!!! note
This is an alpha feature. It is recommended to be on the latest Kubernetes when using this feature.</p>
<pre tabindex="0"><code>$ drycc autoscale set web --min=3 --max=8 --cpu-percent=75
Applying autoscale settings for process type web on scenic-icehouse... done
</code></pre><p>And then review the scaling rule that was created for <code>web</code></p>
<pre tabindex="0"><code>$ drycc autoscale list
PTYPE    PERCENT    MIN    MAX
web      75         3      8
</code></pre><p>Remove scaling rule</p>
<pre tabindex="0"><code>$ drycc autoscale unset web
Removing autoscale for process type web on scenic-icehouse... done
</code></pre><p>For autoscaling to work CPU requests have to be specified on each application Pod (can be done via <code>drycc limits --cpu</code>). This allows the autoscale policies to do the <a href="https://github.com/kubernetes/community/blob/master/contributors/design-proposals/horizontal-pod-autoscaler.md#autoscaling-algorithm">appropriate calculations</a> and make decisions on when to scale up and down.</p>
<p>Scale up can only happen if there was no rescaling within the last 3 minutes. Scale down will wait for 5 minutes from the last rescaling. That information and more can be found at <a href="https://github.com/kubernetes/community/blob/master/contributors/design-proposals/horizontal-pod-autoscaler.md#autoscaling-algorithm">HPA algorithm page</a>.</p>
<h2 id="fetch-a-container-logs-of-the-application">Fetch a container logs of the application<a class="td-heading-self-link" href="#fetch-a-container-logs-of-the-application" aria-label="Heading self-link"></a></h2>
<p>List the containers:</p>
<pre tabindex="0"><code>$ drycc ps
NAME                                                RELEASE    STATE    PTYPEE     READY    RESTARTS     STARTED
python-getting-started-web-69b7d4bfdc-kl4xf         v2         up       web        1/1      0             2023-12-08T02:25:00UTC

=== python-getting-started Processes
--- web:
python-getting-started-web-69b7d4bfdc-kl4xf up (v2)
</code></pre><p>fetch the container logs:</p>
<pre tabindex="0"><code>$ drycc ps logs -f python-getting-started-web-69b7d4bfdc-kl4xf
[2024-05-24 07:14:39 +0000] [1] [INFO] Starting gunicorn 20.1.0
[2024-05-24 07:14:39 +0000] [1] [INFO] Listening at: http://0.0.0.0:8000 (1)
[2024-05-24 07:14:39 +0000] [1] [INFO] Using worker: gevent
[2024-05-24 07:14:39 +0000] [8] [INFO] Booting worker with pid: 8
[2024-05-24 07:14:39 +0000] [9] [INFO] Booting worker with pid: 9
[2024-05-24 07:14:39 +0000] [10] [INFO] Booting worker with pid: 10
[2024-05-24 07:14:39 +0000] [11] [INFO] Booting worker with pid: 11
</code></pre><h2 id="get-a-container-info-of-the-application">Get a container info of the application<a class="td-heading-self-link" href="#get-a-container-info-of-the-application" aria-label="Heading self-link"></a></h2>
<p>List the containers:</p>
<pre tabindex="0"><code>$ drycc ps describe python-getting-started-web-69b7d4bfdc-kl4xf
Container:        python-getting-started-web                   
Image:            drycc/python-getting-started:latest          
Command:          
Args:             
                  - gunicorn                                   
                  - -c                                         
                  - gunicorn_config.py                         
                  - helloworld.wsgi:application                
State:            running                                      
  startedAt:      &#34;2024-05-24T07:14:39Z&#34;                       
Ready:            true                                         
Restart Count:    0                 
</code></pre><h2 id="delete-a-container-of-the-application">delete a container of the application<a class="td-heading-self-link" href="#delete-a-container-of-the-application" aria-label="Heading self-link"></a></h2>
<p>Delete the containers.
Due to the set number of replicas, a new container will be launched to meet the quantity requirement.</p>
<pre tabindex="0"><code>$ drycc ps delete python-getting-started-web-69b7d4bfdc-kl4xf
Deleting python-getting-started-web-69b7d4bfdc-kl4xf from python-getting-started... done
</code></pre><h2 id="get-a-shell-to-a-running-container">Get a Shell to a Running Container<a class="td-heading-self-link" href="#get-a-shell-to-a-running-container" aria-label="Heading self-link"></a></h2>
<p>Verify that the container is running:</p>
<pre tabindex="0"><code>$ drycc ps
NAME                                                RELEASE    STATE    PTYPEE     READY    RESTARTS     STARTED
python-getting-started-web-69b7d4bfdc-kl4xf         v2         up       web        1/1      0             2023-12-08T02:25:00UTC

=== python-getting-started Processes
--- web:
python-getting-started-web-69b7d4bfdc-kl4xf up (v2)
</code></pre><p>Get a shell to the running container:</p>
<pre tabindex="0"><code>$ drycc ps exec python-getting-started-web-69b7d4bfdc-kl4xf -it -- bash
</code></pre><p>In your shell, list the root directory:</p>
<pre tabindex="0"><code># Run this inside the container
ls /
</code></pre><p>Running individual commands in a container</p>
<pre tabindex="0"><code>$ drycc ps exec python-getting-started-web-69b7d4bfdc-kl4xf -- date
</code></pre><p>Use &ldquo;drycc ps &ndash;help&rdquo; for a list of global command-line (applies to all commands).</p>
<h2 id="restarting-an-application-processes">Restarting an Application Processes<a class="td-heading-self-link" href="#restarting-an-application-processes" aria-label="Heading self-link"></a></h2>
<p>If you need to restart an application process, you may use <code>drycc pts restart</code>. Behind the scenes, Drycc Workflow instructs
Kubernetes to terminate the old process and launch a new one in its place.</p>
<pre tabindex="0"><code>$ drycc ps
NAME                                               RELEASE    STATE       PTYPE      READY    RESTARTS     STARTED
scenic-icehouse-web-3291896318-vokg7               v2         up          web        1/1      0            2023-12-08T02:25:00UTC
scenic-icehouse-web-3291896318-rsekj               v2         up          web        1/1      0            2023-12-08T02:50:21UTC
scenic-icehouse-web-3291896318-vokg7               v2         up          web        1/1      0            2023-12-08T02:25:00UTC
scenic-icehouse-background-3291896318-yf8kh        v2         up          web        1/1      0            2023-12-08T02:25:00UTC

$ drycc pts restart scenic-icehouse-background
NAME                                               RELEASE    STATE       PTYPE      READY    RESTARTS    STARTED
scenic-icehouse-web-3291896318-vokg7               v2         up          web        1/1      0           2023-12-08T02:25:00UTC
scenic-icehouse-web-3291896318-rsekj               v2         up          web        1/1      0           2023-12-08T02:50:21UTC
scenic-icehouse-web-3291896318-vokg7               v2         up          web        1/1      0           2023-12-08T02:25:00UTC
scenic-icehouse-background-3291896318-yf8kh        v2         starting    web        1/1      0           2023-12-08T02:25:00UTC
</code></pre><p>Notice that the process name has changed from <code>scenic-icehouse-background-3291896318-yf8kh</code> to
<code>scenic-icehouse-background-3291896318-yd87g</code>. In a multi-node Kubernetes cluster, this may also have the effect of scheduling
the Pod to a new node.</p>
<p>Use &ldquo;drycc pts &ndash;help&rdquo; for a list of pts command-line (process types info).</p>
<h2 id="list-an-application-process-types">List an Application Process Types<a class="td-heading-self-link" href="#list-an-application-process-types" aria-label="Heading self-link"></a></h2>
<pre tabindex="0"><code>$ drycc pts
NAME          RELEASE    READY    UP-TO-DATE    AVAILABLE    GARBAGE    STARTED                   
web           v2         3/3      1             1            true       2023-12-08T02:25:00UTC    
background    v2         1/1      1             1            false      2023-12-08T02:25:00UTC    
</code></pre><h2 id="clean-a-process-types">Clean a Process Types<a class="td-heading-self-link" href="#clean-a-process-types" aria-label="Heading self-link"></a></h2>
<p>Clean up non-existent ptypes, it is usually executed automatically when autodeploy is set to <code>true</code>.</p>
<pre tabindex="0"><code>$ drycc pts clean background
</code></pre><h2 id="get-deployment-info-of-the-application-process-type">Get deployment info of the application process type<a class="td-heading-self-link" href="#get-deployment-info-of-the-application-process-type" aria-label="Heading self-link"></a></h2>
<pre tabindex="0"><code>$ drycc pts describe web
Container:    python-getting-started-web                   
Image:        drycc/python-getting-started:latest          
Command:      
Args:         
              - gunicorn                                   
              - -c                                         
              - gunicorn_config.py                         
              - helloworld.wsgi:application                
Limits:       
              cpu 1                                                                                               
              ephemeral-storage 2Gi                                                                               
              memory 1Gi                                                                                          
Liveness:     http-get headers=[] path=/geo/ port=8000 delay=120s timeout=10s period=20s #success=1 #failure=3    
Readiness:    http-get headers=[] path=/geo/ port=8000 delay=120s timeout=10s period=20s #success=1 #failure=3  
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f7fe2ebef366052e0d8bfb14e3e044f5">6 - Configuring an Application</h1>
    <div class="lead">How to store configuration of a Drycc app in the environment, keeping config out of code, making it easy to maintain app or deployment specific configs.</div>
	<h1 id="configuring-an-application">Configuring an Application<a class="td-heading-self-link" href="#configuring-an-application" aria-label="Heading self-link"></a></h1>
<p>A Drycc application <a href="http://12factor.net/config">stores config in environment variables</a>.</p>
<h2 id="setting-environment-variables">Setting Environment Variables<a class="td-heading-self-link" href="#setting-environment-variables" aria-label="Heading self-link"></a></h2>
<p>Use <code>drycc config</code> to modify environment variables for a deployed application.</p>
<pre><code>$ drycc help config
Manage environment variables that define app config

Usage:
drycc config [flags]
drycc config [command]

Available Commands:
info        An app config info
set         Set environment variables for an app
unset       Unset environment variables for an app
pull        Pull environment variables to the path
push        Push environment variables from the path
attach      Selects environment groups to attach an app ptype
detach      Selects environment groups to detach an app ptype

Flags:
-a, --app string     The uniquely identifiable name for the application
-g, --group string   The group for which the config needs to be listed
-p, --ptype string   The ptype for which the config needs to be listed
-v, --version int    The version for which the config needs to be listed

Global Flags:
-c, --config string   Path to configuration file. (default &quot;~/.drycc/client.json&quot;)
-h, --help            Display help information

Use &quot;drycc config [command] --help&quot; for more information about a command.
</code></pre>
<p>When config is changed, a new release is created and deployed automatically.</p>
<p>You can set multiple environment variables with one <code>drycc config set</code> command,
or with <code>drycc config push</code> and a local .env file.</p>
<pre><code>$ drycc config set FOO=1 BAR=baz &amp;&amp; drycc config pull
$ cat .env
FOO=1
BAR=baz
$ echo &quot;TIDE=high&quot; &gt;&gt; .env
$ drycc config push
Creating config... done, v4

=== yuppie-earthman
DRYCC_APP: yuppie-earthman
FOO: 1
BAR: baz
TIDE: high
</code></pre>
<p>It can modify environment variables for a process type of application.</p>
<pre><code>$ drycc config set FOO=1 BAR=baz --ptype=web
</code></pre>
<p>It can also modify environment variables for a environment group.</p>
<pre><code>$ drycc config set FOO1=1 BAR1=baz --group=web.env
</code></pre>
<p>Then bind this environment variable group to the web.</p>
<pre><code>$ drycc config attach web web.env
</code></pre>
<p>Of course, you can also detach it.</p>
<pre><code>$ drycc config detach web web.env
</code></pre>
<h2 id="attach-to-backing-services">Attach to Backing Services<a class="td-heading-self-link" href="#attach-to-backing-services" aria-label="Heading self-link"></a></h2>
<p>Drycc treats backing services like databases, caches and queues as <a href="http://12factor.net/backing-services">attached resources</a>.
Attachments are performed using environment variables.</p>
<p>For example, use <code>drycc config</code> to set a <code>DATABASE_URL</code> that attaches
the application to an external PostgreSQL database.</p>
<pre><code>$ drycc config set DATABASE_URL=postgres://user:pass@example.com:5432/db
=== peachy-waxworks
DATABASE_URL: postgres://user:pass@example.com:5432/db
</code></pre>
<p>Detachments can be performed with <code>drycc config unset</code>.</p>
<h2 id="buildpacks-cache">Buildpacks Cache<a class="td-heading-self-link" href="#buildpacks-cache" aria-label="Heading self-link"></a></h2>
<p>By default, apps using the [Imagebuilder][] will reuse the latest image data.
When deploying applications that depend on third-party libraries that have to be fetched,
this could speed up deployments a lot. In order to make use of this, the buildpack must implement
the cache by writing to the cache directory. Most buildpacks already implement this, but when using
custom buildpacks, it might need to be changed to make full use of the cache.</p>
<h3 id="disabling-and-re-enabling-the-cache">Disabling and re-enabling the cache<a class="td-heading-self-link" href="#disabling-and-re-enabling-the-cache" aria-label="Heading self-link"></a></h3>
<p>In some cases, cache might not speed up your application. To disable caching, you can set the
<code>DRYCC_DISABLE_CACHE</code> variable with <code>drycc config set DRYCC_DISABLE_CACHE=1</code>. When you disable the
cache, Drycc will clear up files it created to store the cache. After having it turned off, run
<code>drycc config unset DRYCC_DISABLE_CACHE</code> to re-enable the cache.</p>
<h3 id="clearing-the-cache">Clearing the cache<a class="td-heading-self-link" href="#clearing-the-cache" aria-label="Heading self-link"></a></h3>
<p>Use the following procedure to clear the cache:</p>
<pre><code>$ drycc config set DRYCC_DISABLE_CACHE=1
$ git commit --allow-empty -m &quot;Clearing Drycc cache&quot;
$ git push drycc # (if you use a different remote, you should use your remote name)
$ drycc config unset DRYCC_DISABLE_CACHE
</code></pre>
<h2 id="custom-health-checks">Custom Health Checks<a class="td-heading-self-link" href="#custom-health-checks" aria-label="Heading self-link"></a></h2>
<p>By default, Workflow only checks that the application starts in their Container. A health
check may be added by configuring a health check probe for the application. The health
checks are implemented as Kubernetes Container Probes. A &lsquo;startupProbe&rsquo; &rsquo;livenessProbe&rsquo;
and a &lsquo;readinessProbe&rsquo; can be configured, and each probe can be of type &lsquo;httpGet&rsquo;, &rsquo;exec&rsquo;
or &rsquo;tcpSocket&rsquo; depending on the type of probe the Container requires.</p>
<p>A &lsquo;startupProbe&rsquo; indicates whether the application within the container is started.
All other probes are disabled if a startup probe is provided, until it succeeds.
If the startup probe fails, the container is subjected to its restart policy.</p>
<p>A &rsquo;livenessProbe&rsquo; is useful for applications running for long periods of time, eventually
transitioning to broken states and cannot recover except by restarting them.</p>
<p>Other times, a &lsquo;readinessProbe&rsquo; is useful when the Container is only temporarily unable
to serve, and will recover on its own. In this case, if a Container fails its &lsquo;readinessProbe&rsquo;
, the Container will not be shut down, but rather the Container will stop receiving
incoming requests.</p>
<p>&lsquo;httpGet&rsquo; probes are just as it sounds: it performs a HTTP GET operation on the Container.
A response code inside the 200-399 range is considered a pass. &lsquo;httpGet&rsquo; probes accept a
port number to perform the HTTP GET operation on the Container.</p>
<p>&rsquo;exec&rsquo; probes run a command inside the Container to determine its health. An exit code of
zero is considered a pass, while a non-zero status code is considered a fail. &rsquo;exec&rsquo;
probes accept a string of arguments to be run inside the Container.</p>
<p>&rsquo;tcpSocket&rsquo; probes attempt to open a socket in the Container. The Container is only
considered healthy if the check can establish a connection. &rsquo;tcpSocket&rsquo; probes accept a
port number to perform the socket connection on the Container.</p>
<p>Health checks can be configured on a per-proctype basis for each application using <code>drycc healthchecks set</code>. If no type is mentioned then the health checks are applied to default proc type web, whichever is present. To
configure a <code>httpGet</code> liveness probe:</p>
<pre tabindex="0"><code>$ drycc healthchecks set livenessProbe httpGet 80 --ptype web
Applying livenessProbe healthcheck... done

App:             peachy-waxworks
UUID:            afd84067-29e9-4a5f-9f3a-60d91e938812
Owner:           dev
Created:         2023-12-08T10:25:00Z
Updated:         2023-12-08T10:25:00Z
Healthchecks:
                 livenessProbe web http-get headers=[] path=/ port=80 delay=50s timeout=50s period=10s #success=1 #failure=3
</code></pre><p>If the application relies on certain headers being set (such as the <code>Host</code> header) or a specific
URL path relative to the root, you can also send specific HTTP headers:</p>
<pre tabindex="0"><code>$ drycc healthchecks set livenessProbe httpGet 80 \
    --path /welcome/index.html \
    --headers &#34;X-Client-Version:v1.0,X-Foo:bar&#34;
Applying livenessProbe healthcheck... done

App:             peachy-waxworks
UUID:            afd84067-29e9-4a5f-9f3a-60d91e938812
Owner:           dev
Created:         2023-12-08T10:25:00Z
Updated:         2023-12-08T10:25:00Z
Healthchecks:
                 livenessProbe web http-get headers=[X-Client-Version=v1.0] path=/welcome/index.html port=80 delay=50s timeout=50s period=10s #success=1 #failure=3
</code></pre><p>To configure an <code>exec</code> readiness probe:</p>
<pre tabindex="0"><code>$ drycc healthchecks set readinessProbe exec -- /bin/echo -n hello --ptype web
Applying readinessProbe healthcheck... done

App:             peachy-waxworks
UUID:            afd84067-29e9-4a5f-9f3a-60d91e938812
Owner:           dev
Created:         2023-12-08T10:25:00Z
Updated:         2023-12-08T10:25:00Z
Healthchecks:
                 readinessProbe web exec /bin/echo -n hello delay=50s timeout=50s period=10s #success=1 #failure=3
</code></pre><p>You can overwrite a probe by running <code>drycc healthchecks set</code> again:</p>
<pre tabindex="0"><code>$ drycc healthchecks set readinessProbe httpGet 80 --ptype web
Applying livenessProbe healthcheck... done

App:             peachy-waxworks
UUID:            afd84067-29e9-4a5f-9f3a-60d91e938812
Owner:           dev
Created:         2023-12-08T10:25:00Z
Updated:         2023-12-08T10:25:00Z
Healthchecks:
                 livenessProbe web http-get headers=[] path=/ port=80 delay=50s timeout=50s period=10s #success=1 #failure=3
</code></pre><p>Configured health checks also modify the default application deploy behavior. When starting a new
Pod, Workflow will wait for the health check to pass before moving onto the next Pod.</p>
<h2 id="autodeploy">Autodeploy<a class="td-heading-self-link" href="#autodeploy" aria-label="Heading self-link"></a></h2>
<p>By default, Changes the config, limits or healthchecks and so on will trigger deploy.
If you don&rsquo;t want deploy, you can disable.</p>
<pre tabindex="0"><code>$ drycc autodeploy disable
</code></pre><p>To re-enable autodeploy.</p>
<pre tabindex="0"><code>drycc autodeploy enable
</code></pre><p>you can deploy by executing the following command.
deploy all ptypes</p>
<pre tabindex="0"><code>drycc releases deploy
</code></pre><p>deploy web process type, and support <code>--force</code> option to force deploy.</p>
<pre tabindex="0"><code>drycc releases deploy web --force
</code></pre><h2 id="autorollback">Autorollback<a class="td-heading-self-link" href="#autorollback" aria-label="Heading self-link"></a></h2>
<p>By default, deployment failures will roll back to the previous successful version.
If you don&rsquo;t want this to happen, you can disable.</p>
<pre tabindex="0"><code>$ drycc autorollback disable
</code></pre><p>To re-enable autorollback.</p>
<pre tabindex="0"><code>drycc autorollback enable
</code></pre><h2 id="isolate-the-application">Isolate the Application<a class="td-heading-self-link" href="#isolate-the-application" aria-label="Heading self-link"></a></h2>
<p>Workflow supports isolating applications onto a set of nodes using <code>drycc tags</code>.</p>
<p>!!! note
In order to use tags, you must first launch your cluster with the proper node labels. If you do
not, tag commands will fail. Learn more by reading <a href="http://kubernetes.io/docs/user-guide/node-selection/">&ldquo;Assigning Pods to Nodes&rdquo;</a>.</p>
<p>Once your nodes are configured with appropriate label selectors, use <code>drycc tags set</code> to restrict
the application ptype to those nodes:</p>
<pre tabindex="0"><code>$ drycc tags set web environ=prod
Applying tags...  done, v4

environ  prod
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-9db3915fd6ded30b69a25418cc7df8c0">7 - Managing Application Metrics</h1>
    <div class="lead">Metrics supports basic monitoring capabilities for Pod, providing various monitoring indicators such as CPU, memory, disk, network, etc., to meet the basic monitoring requirements for Pod resources.</div>
	<h2 id="create-an-authentication-token">Create an authentication token<a class="td-heading-self-link" href="#create-an-authentication-token" aria-label="Heading self-link"></a></h2>
<p>Create an authentication token using the drycc client.</p>
<pre tabindex="0"><code># drycc tokens add prometheus --password admin --username admin
 !    WARNING: Make sure to copy your token now.
 !    You won&#39;t be able to see it again, please confirm whether to continue.
 !    To proceed, type &#34;yes&#34; !

&gt; yes
UUID                                  USERNAME    TOKEN                                                                                              
58176cf1-37a8-4c52-9b27-4c7a47269dfb  admin       1F2c7A802aF640fd9F31dD846AdDf56BcMsay
</code></pre><h2 id="add-scrape-configurations-for-prometheus">Add scrape configurations for prometheus<a class="td-heading-self-link" href="#add-scrape-configurations-for-prometheus" aria-label="Heading self-link"></a></h2>
<p>A valid example file can be found here.</p>
<p>The global configuration specifies parameters that are valid in all other configuration contexts. They also serve as defaults for other configuration sections.</p>
<pre tabindex="0"><code>global:
  scrape_interval:   60s
  evaluation_interval: 60s
scrape_configs:
- job_name: &#39;drycc&#39;
  scheme: https
  metrics_path: /v2/apps/&lt;appname&gt;/metrics
  authorization:
    type: Token
    credentials: 1F2c7A802aF640fd9F31dD846AdDf56BcMsay
  static_configs:
  - targets: [&#39;drycc.domain.com&#39;]
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-8b23c65b4ab7634b1e278d7873029bf6">8 - Managing an Application</h1>
    <div class="lead">This is a high-level, technical description of how Drycc works. It ties together many of the concepts you&rsquo;ll encounter while writing, configuring, deploying and running applications on the Drycc platform.</div>
	<h2 id="track-application-changes">Track Application Changes<a class="td-heading-self-link" href="#track-application-changes" aria-label="Heading self-link"></a></h2>
<p>Drycc Workflow tracks all changes to your application. Application changes are the result of either new application code
pushed to the platform (via <code>git push drycc master</code>), or an update to application configuration (via <code>drycc config:set KEY=VAL</code>).</p>
<p>Each time a build or config change is made to your application a new <a href="../reference-guide/terms.md#release">release</a> is created. These release numbers
increase monotonically.</p>
<p>You can see a record of changes to your application using <code>drycc releases</code>:</p>
<pre tabindex="0"><code>$ drycc releases
OWNER    STATE      VERSION    CREATED                 SUMMARY
dev      succeed    v3         2023-12-04T10:17:46Z    dev deleted PIP_INDEX_URL, DISABLE_COLLECTSTATIC
dev      succeed    v2         2023-12-01T10:20:22Z    dev added IMAGE_PULL_POLICY, PIP_INDEX_URL, PORT, DISABLE_COLLEC[...]
dev      succeed    v1         2023-11-30T17:54:57Z    dev created initial release
</code></pre><h2 id="rollback-a-release">Rollback a Release<a class="td-heading-self-link" href="#rollback-a-release" aria-label="Heading self-link"></a></h2>
<p>Drycc Workflow also supports rolling back go previous releases. If buggy code or an errant configuration change is pushed
to your application, you may rollback to a previously known, good release.</p>
<p>!!! note
All rollbacks create a new, numbered release. But will reference the build/code and configuration from the desired rollback point.</p>
<p>In this example, the application is currently running release v4. Using <code>drycc rollback v2</code> tells Workflow to deploy the
build and configuration that was used for release v2. This creates a new release named v5 whose contents are the source
and configuration from release v2:</p>
<pre tabindex="0"><code>$ drycc releases
OWNER    STATE      VERSION    CREATED                 SUMMARY
dev      succeed    v3         2023-12-04T10:17:46Z    dev deleted PIP_INDEX_URL, DISABLE_COLLECTSTATIC
dev      succeed    v2         2023-12-01T10:20:22Z    dev added IMAGE_PULL_POLICY, PIP_INDEX_URL, PORT, DISABLE_COLLEC[...]
dev      succeed    v1         2023-11-30T17:54:57Z    dev created initial release

$ drycc rollback v2
Rolled back to v2

$ drycc releases
OWNER    STATE      VERSION    CREATED                 SUMMARY
dev      succeed    v4         2023-12-04T10:20:46Z    dev rolled back to v2
dev      succeed    v3         2023-12-04T10:17:46Z    dev deleted PIP_INDEX_URL, DISABLE_COLLECTSTATIC
dev      succeed    v2         2023-12-01T10:20:22Z    dev added IMAGE_PULL_POLICY, PIP_INDEX_URL, PORT, DISABLE_COLLEC[...]
dev      succeed    v1         2023-11-30T17:54:57Z    dev created initial release
</code></pre><p>Only rollback web process type:</p>
<pre tabindex="0"><code>$ drycc rollback v3 web
Rolled back to v3

$ drycc releases
OWNER    STATE      VERSION    CREATED                 SUMMARY
dev      succeed    v5         2023-12-04T10:23:49Z    dev rolled back to v3
dev      succeed    v4         2023-12-04T10:20:46Z    dev rolled back to v2
dev      succeed    v3         2023-12-04T10:17:46Z    dev deleted PIP_INDEX_URL, DISABLE_COLLECTSTATIC
dev      succeed    v2         2023-12-01T10:20:22Z    dev added IMAGE_PULL_POLICY, PIP_INDEX_URL, PORT, DISABLE_COLLEC[...]
dev      succeed    v1         2023-11-30T17:54:57Z    dev created initial release
</code></pre><h2 id="run-one-off-administration-tasks">Run One-off Administration Tasks<a class="td-heading-self-link" href="#run-one-off-administration-tasks" aria-label="Heading self-link"></a></h2>
<p>Drycc applications <a href="http://12factor.net/admin-processes">use one-off processes for admin tasks</a> like database migrations and other commands that must run against the live application.</p>
<p>Use <code>drycc run</code> to execute commands on the deployed application.</p>
<pre><code>$ drycc run -- 'ls -l'
Running `ls -l`...

total 28
-rw-r--r-- 1 root root  553 Dec  2 23:59 LICENSE
-rw-r--r-- 1 root root   60 Dec  2 23:59 Procfile
-rw-r--r-- 1 root root   33 Dec  2 23:59 README.md
-rw-r--r-- 1 root root 1622 Dec  2 23:59 pom.xml
drwxr-xr-x 3 root root 4096 Dec  2 23:59 src
-rw-r--r-- 1 root root   25 Dec  2 23:59 system.properties
drwxr-xr-x 6 root root 4096 Dec  3 00:00 target
</code></pre>
<h2 id="share-an-application">Share an Application<a class="td-heading-self-link" href="#share-an-application" aria-label="Heading self-link"></a></h2>
<p>Use <code>drycc perms add</code> to allow another Drycc user to collaborate on your application.</p>
<pre tabindex="0"><code>$ drycc perms add otheruser view,change,delete
Adding user otheruser as a collaborator for view,change,delete peachy-waxwork... done
</code></pre><p>Use <code>drycc perms</code> to see who an application is currently shared with, and <code>drycc perms remove</code> to remove a collaborator.</p>
<p>!!! note
Collaborators can do anything with an application that its owner can do, except delete the application.</p>
<p>When working with an application that has been shared with you, clone the original repository and add Drycc&rsquo; git remote
entry before attempting to <code>git push</code> any changes to Drycc.</p>
<pre tabindex="0"><code>$ git clone https://github.com/drycc/example-java-jetty.git
Cloning into &#39;example-java-jetty&#39;... done
$ cd example-java-jetty
$ git remote add -f drycc ssh://git@local3.dryccapp.com:2222/peachy-waxworks.git
Updating drycc
From drycc-controller.local:peachy-waxworks
 * [new branch]      master     -&gt; drycc/master
</code></pre><h2 id="application-troubleshooting">Application Troubleshooting<a class="td-heading-self-link" href="#application-troubleshooting" aria-label="Heading self-link"></a></h2>
<p>Applications deployed on Drycc Workflow <a href="http://12factor.net/logs">treat logs as event streams</a>. Drycc Workflow aggregates <code>stdout</code> and <code>stderr</code>
from every <a href="../reference-guide/terms.md#container">Container</a> making it easy to troubleshoot problems with your application.</p>
<p>Use <code>drycc logs</code> to view the log output from your deployed application.</p>
<pre><code>$ drycc logs -f
Dec  3 00:30:31 ip-10-250-15-201 peachy-waxworks[web.5]: INFO:oejsh.ContextHandler:started o.e.j.s.ServletContextHandler{/,null}
Dec  3 00:30:31 ip-10-250-15-201 peachy-waxworks[web.8]: INFO:oejs.Server:jetty-7.6.0.v20120127
Dec  3 00:30:31 ip-10-250-15-201 peachy-waxworks[web.5]: INFO:oejs.AbstractConnector:Started SelectChannelConnector@0.0.0.0:10005
Dec  3 00:30:31 ip-10-250-15-201 peachy-waxworks[web.6]: INFO:oejsh.ContextHandler:started o.e.j.s.ServletContextHandler{/,null}
Dec  3 00:30:31 ip-10-250-15-201 peachy-waxworks[web.7]: INFO:oejsh.ContextHandler:started o.e.j.s.ServletContextHandler{/,null}
Dec  3 00:30:31 ip-10-250-15-201 peachy-waxworks[web.6]: INFO:oejs.AbstractConnector:Started SelectChannelConnector@0.0.0.0:10006
Dec  3 00:30:31 ip-10-250-15-201 peachy-waxworks[web.8]: INFO:oejsh.ContextHandler:started o.e.j.s.ServletContextHandler{/,null}
Dec  3 00:30:31 ip-10-250-15-201 peachy-waxworks[web.7]: INFO:oejs.AbstractConnector:Started SelectChannelConnector@0.0.0.0:10007
Dec  3 00:30:31 ip-10-250-15-201 peachy-waxworks[web.8]: INFO:oejs.AbstractConnector:Started SelectChannelConnector@0.0.0.0:10008
</code></pre>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4f70d2fc7490bc1f7a4aba25dd86ea12">9 - Mounting volumes for an Application</h1>
    <div class="lead">Drycc supports many types of volumes. A container can use any number of volume types simultaneously.</div>
	<p>We can use the blow command to create volumes and mount the created volumes.
Drycc create volume support <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#access-modes">ReadWriteMany</a>, so before deploying drycc, you need to have a StorageClass ready which can support ReadWriteMany.
Deploying drycc, set controller.appStorageClass to this StorageClass.</p>
<p>Use <code>drycc volumes</code> to mount a volume for a deployed application&rsquo;s processes.</p>
<pre><code>$ drycc help volumes
Valid commands for volumes:

add              create a volume for the application
expand           expand a volume for the application
list             list volumes in the application
info             print information about a volume
remove           delete a volume from the application
client           the client used to manage volume files
mount            mount a volume to process of the application
unmount          unmount a volume from process of the application

Use 'drycc help [command]' to learn more.
</code></pre>
<h2 id="create-a-volume-for-the-application">Create a volume for the application<a class="td-heading-self-link" href="#create-a-volume-for-the-application" aria-label="Heading self-link"></a></h2>
<p>You can create a csi volume with the <code>drycc volumes add</code> command.</p>
<pre><code>$ drycc volumes add myvolume 200M
Creating myvolume to scenic-icehouse... done
</code></pre>
<p>Or use an existing nfs server</p>
<pre><code>$ drycc volumes add mynfsvolume 200M -t nfs --nfs-server=nfs.drycc.com --nfs-path=/
Creating mynfsvolume to scenic-icehouse... done
</code></pre>
<p>Or maybe use an existing oss3</p>
<pre><code>$ drycc volumes add myossvolume 200M -t oss --oss-server=oss.drycc.com --oss-bucket=vbucket --oss-access-key=ak --oss-secret-key=sk
Creating myossvolume to scenic-icehouse... done
</code></pre>
<h2 id="list-volumes-in-the-application">List volumes in the application<a class="td-heading-self-link" href="#list-volumes-in-the-application" aria-label="Heading self-link"></a></h2>
<p>After volume is created, you can list the volumes in this application.</p>
<pre><code>$ drycc volumes list
NAME          OWNER    TYPE    PTYPE    PATH     SIZE
myvolume      admin    csi                       200M
mynfsvolume   admin    nfs                       200M
myossvolume   admin    oss                       200M
</code></pre>
<h2 id="mount-a-volume">Mount a volume<a class="td-heading-self-link" href="#mount-a-volume" aria-label="Heading self-link"></a></h2>
<p>The volume which is named myvolume is created, you can mount the volume with process of the application,
use the command of <code>drycc volumes mount</code>. When volume is mounted, a new release will be created and deployed automatically.</p>
<pre><code>$ drycc volumes mount myvolume web=/data/web
Mounting volume... done
</code></pre>
<p>And use <code>drycc volumes list</code> show mount detail.</p>
<pre><code>$ drycc volumes list
NAME       OWNER    TYPE    PTYPE    PATH         SIZE
myvolume   admin    nfs     web      /data/web    200M
</code></pre>
<p>If you don&rsquo;t need the volume, use <code>drycc volumes unmount</code> to unmount the volume and then use  <code>drycc volumes remove</code> to delete the volume from the application.
Before deleting volume, the volume has to be unmounted.</p>
<pre><code>$ drycc volumes unmount myvolume web
Unmounting volume... done

$ drycc volumes remove myvolume
Deleting myvolume from scenic-icehouse... done
</code></pre>
<h2 id="use-volume-client-to-manage-volume-files">Use volume client to manage volume files.<a class="td-heading-self-link" href="#use-volume-client-to-manage-volume-files" aria-label="Heading self-link"></a></h2>
<p>Assume the volume which is named myvolume is created and mounted.</p>
<p>Prepare a file named testfile.</p>
<pre><code>$ echo &quot;testtext&quot; &gt; testfile
</code></pre>
<p>Upload.
$ drycc volumes client cp testfile vol://myvolume/
[↑] testfile                       100% [==================================================] (5/ 5 B, 355 B/s)</p>
<p>List files in myvolume.</p>
<pre><code>$ drycc volumes client ls vol://myvolume/
[2024-07-22T15:32:28+08:00]    5    testfile
</code></pre>
<p>Delete testfle in myvolume.</p>
<pre><code>$ drycc volumes client rm vol://myvolume/testfile</code></pre>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d364e5ac44490f83dacb071ecdaaebb8">10 - About gateway for an Application</h1>
    <div class="lead">A Gateway describes how traffic can be translated to Services within the cluster.</div>
	<p>A <a href="https://gateway-api.sigs.k8s.io/">Gateway</a> describes how traffic can be translated to Services within the cluster. That is, it defines a request for a way to translate traffic from somewhere that does not know about Kubernetes to somewhere that does. For example, traffic sent to a Kubernetes Service by a cloud load balancer, an in-cluster proxy, or an external hardware load balancer. While many use cases have client traffic originating “outside” the cluster, this is not a requirement.</p>
<h2 id="create-gateway-for-an-application">Create Gateway for an Application<a class="td-heading-self-link" href="#create-gateway-for-an-application" aria-label="Heading self-link"></a></h2>
<p>Gateway is a way of exposing services externally, which generates an external IP address to connect route and service.
After deploy, the gateway has been created.</p>
<p>List the containers:</p>
<pre tabindex="0"><code># drycc gateways
NAME                      LISENTER       PORT     PROTOCOL    ADDRESSES      
python-getting-started    tcp-80-0       80       HTTP        101.65.132.51     
</code></pre><p>You can also add a port in this gateway or create a one.</p>
<pre tabindex="0"><code># drycc gateways add python-getting-started --port=443 --protocol=HTTPS
Adding gateway python-getting-started to python-getting-started... done     
</code></pre><h2 id="create-service-for-an-application">Create service for an Application<a class="td-heading-self-link" href="#create-service-for-an-application" aria-label="Heading self-link"></a></h2>
<p>Service is a way of exposing services internally, creating a service generates an internal DNS that can access <code>ptype</code>.
the web process type has been created, for others types, you should add as needed.</p>
<p>List the services:</p>
<pre tabindex="0"><code>$ drycc services
PTYPE      PORT    PROTOCOL    TARGET-PORT    DOMAIN                                    
web        80      TCP         8000           python-getting-started.python-getting-started.svc.cluster.local  
</code></pre><p>Add a new service for process type</p>
<pre tabindex="0"><code># drycc services add --help
# drycc services add sleep 8001:8001
</code></pre><h2 id="create-route-for-an-application">Create Route for an Application<a class="td-heading-self-link" href="#create-route-for-an-application" aria-label="Heading self-link"></a></h2>
<p>A Gateway may be attached to one or more Route references which serve to direct traffic for a subset of traffic to a specific service.
Same as the above， the web process type already bind the gateway and servies.</p>
<pre tabindex="0"><code># drycc routes
NAME                           OWNER        KIND           GATEWAYS                              SERVICES       
python-getting-started         demo         HTTPRoute      [&#34;python-getting-started:80&#34;]         [&#34;python-getting-started:80&#34;]      
</code></pre><p>create a new route and attach gateway.</p>
<pre tabindex="0"><code>drycc routes add sleep HTTPRoute --ptype=sleep  sleep:8001,100
drycc routes attach sleep --gateway=python-getting-started --port=80
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b120b91d31144e14252d09e3351ac63d">11 - Managing resources for an Application</h1>
    <div class="lead">Tools and services for developing, extending, and operating your app.</div>
	<p>We can use blow command to create resources and bind which resource is created.
This command depend on <a href="https://service-catalog.drycc.cc">service-catalog</a>.</p>
<p>Use <code>drycc resources</code> to create and bind a resource for a deployed application.</p>
<pre><code>$ drycc help resources
Manage resources for your applications

Usage:
drycc resources [flags]
drycc resources [command]

Available Commands:
services    List all available resource services
plans       List all available plans for a resource service
create      Create a resource for the application
list        List resources in the application
describe    Get a resource's detail in the application
update      Update a resource from the application
bind        Bind a resource for an application
unbind      unbind a resources for an application
destroy     Delete a resource from the application

Flags:
-a, --app string   The uniquely identifiable name for the application
-l, --limit int    The maximum number of results to display

Global Flags:
-c, --config string   Path to configuration file. (default &quot;~/.drycc/client.json&quot;)
-h, --help            Display help information
-v, --version         Display client version

Use &quot;drycc resources [command] --help&quot; for more information about a command.
</code></pre>
<h2 id="list-all-available-resource-services">List all available resource services<a class="td-heading-self-link" href="#list-all-available-resource-services" aria-label="Heading self-link"></a></h2>
<p>You can list available resource services with one <code>drycc resources services</code> command</p>
<pre><code>$ drycc resources services
ID                                      NAME                  UPDATEABLE 
15032a52-33c2-4b40-97aa-ceb972f51509    airflow               true          
b7cb26a4-b258-445c-860b-a664239a67f8    cloudbeaver           true          
9ce3c3ba-33b5-4e4e-a5e9-a338a83d5070    flink                 true          
b80c51a1-957c-4d93-b3d5-efde84cd8031    fluentbit             true          
fff5b6c7-ed85-429b-8265-493e40cc53c7    grafana               true          
412e368f-bf78-4798-92cc-43343119a57d    kafka                 true          
ea2a9b87-fbc4-4e2a-adee-161c1f91d98d    minio                 true          
383f7316-84f3-4955-8491-1d4b02b749c8    mongodb               true          
fbee746b-f3a7-4bef-8b55-cbecfd4c8ac3    mysql-cluster         true          
5975094d-45cc-4e85-8573-f93937d026c7    opensearch            true          
1db95161-7193-4544-8c76-e5ad5f6c03f6    pmm                   true          
5cfb0abf-276c-445b-9060-9aa964ede87d    postgresql-cluster    true          
b8f70264-eafc-4b2f-848e-2ec0d059032b    prometheus            true    
e1fd0d37-9046-4152-a29b-d155c5657c8b    redis                 true          
7d2b64c6-0b59-4f08-a2f5-7b17cea6e5ee    redis-cluster         true          
2e6877df-86e7-4bcc-a869-2a9b6847a465    seaweedfs             true          
4aea5c0f-9495-420d-896a-ffc61a3eced5    spark                 true          
b50db3b5-8d5f-4be9-b8bd-467ecd6cc11d    zookeeper             true
</code></pre>
<h2 id="list-all-available-plans-for-an-resource-services">List all available plans for an resource services<a class="td-heading-self-link" href="#list-all-available-plans-for-an-resource-services" aria-label="Heading self-link"></a></h2>
<p>You can list all available plans for an resource services with one <code>drycc resources plans</code> command</p>
<pre><code>$ drycc resources plans redis
ID                                      NAME              DESCRIPTION                                                       
8d659058-a3b4-4058-b039-cc03a31b9442    standard-128      Redis standard-128 plan which limit resources memory size 128Mi.     
36e3dbec-fc51-4f6b-9baa-e31e316858be    standard-256      Redis standard-256 plan which limit resources memory size 256Mi.     
560817c2-5aa1-41c4-9ee6-a77e3ee552d5    standard-512      Redis standard-512 plan which limit resources memory size 512Mi.     
d544d989-9fb8-43e9-a74e-0840ce1b8f0f    standard-1024     Redis standard-1024 plan which limit resources memory size 1Gi.      
ad51b7bb-9b12-4ffd-8e49-010c0141b263    standard-2048     Redis standard-2048 plan which limit resources memory size 2Gi.      
5097d76e-557c-453f-bdb1-54009e0df78d    standard-4096     Redis standard-4096 plan which limit resources memory size 4Gi.      
be3fa2d0-36d2-47c5-9561-9deffe5ba373    standard-8192     Redis standard-8192 plan which limit resources memory size 8Gi.      
4ca812a8-d7c3-439f-96cd-26523e88400e    standard-16384    Redis standard-16384 plan which limit resources memory size 16Gi.    
b7f2a71f-0d97-48fd-8eed-aab24a7822f3    standard-32768    Redis standard-32768 plan which limit resources memory size 32Gi.    
25c6b5d5-7505-47c8-95b1-dc9bdc698063    standard-65536    Redis standard-65536 plan which limit resources memory size 64Gi.
</code></pre>
<h2 id="create-resource-in-application">Create resource in application<a class="td-heading-self-link" href="#create-resource-in-application" aria-label="Heading self-link"></a></h2>
<p>You can create a resource with one <code>drycc resources create</code> command</p>
<pre><code>$ drycc resources create redis redis standard-128
Creating redis to scenic-icehouse... done
</code></pre>
<p>After resources are created, you can list the resources in this application.</p>
<pre><code>$ drycc resources list
UUID                                    NAME     OWNER    PLAN                  UPDATED              
07220e9e-d54d-4d74-a88c-f464aa374386    redis    admin    redis:standard-128    2024-05-08T01:01:00Z   
</code></pre>
<h2 id="bind-resources">Bind resources<a class="td-heading-self-link" href="#bind-resources" aria-label="Heading self-link"></a></h2>
<p>The resource which is named redis is created, you can bind the redis to the application,
use the command of <code>drycc resources bind redis</code>.</p>
<pre><code>$ drycc resources bind redis
Binding resource... done
</code></pre>
<h2 id="describe-resources">Describe resources<a class="td-heading-self-link" href="#describe-resources" aria-label="Heading self-link"></a></h2>
<p>And use <code>drycc resources describe</code> show the binding detail. If the binding is successful, this command will show the information of connect to the resource.</p>
<pre><code>$ drycc resources describe redis
=== scenic-icehouse resource redis
plan:               redis:1000
status:             Ready
binding:            Ready

REDISPORT:          6379
REDIS_PASSWORD:     RzG87SJWG1
SENTINELHOST:       172.16.0.2
SENTINELPORT:       26379
</code></pre>
<h2 id="update-resources">Update resources<a class="td-heading-self-link" href="#update-resources" aria-label="Heading self-link"></a></h2>
<p>You can use the <code>drycc resources update</code> command to upgrade a new plan.
An example of how to upgrade the plan&rsquo;s capacity to 128MB:</p>
<pre><code>$ drycc resources update redis redis standard-128
Updating redis to scenic-icehouse... done
</code></pre>
<h2 id="remove-the-resource">Remove the resource<a class="td-heading-self-link" href="#remove-the-resource" aria-label="Heading self-link"></a></h2>
<p>If you don&rsquo;t need resources, use <code>drycc resources unbind</code> to unbind the resource and then use <code>drycc resources destroy</code> to delete the resource from the application.
Before deleting the resource, the resource must be unbinded.</p>
<pre><code>$ drycc resources unbind redis
Unbinding resource... done

$ drycc resources destroy redis
Deleting redis from scenic-icehouse... done
</code></pre>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-af7e8c313c7749aeeb64a743cd877d8c">12 - Inter-app Communication</h1>
    <div class="lead">The Communication Solution between Drycc Applicatios.</div>
	<p>A common architecture pattern of multi-process applications is to have one process serve public requests while having multiple other processes supporting the public one to, for example, perform actions on a schedule or process work items from a queue. To implement this system of apps in Drycc Workflow, set up the apps to communicate using DNS resolution, as shown above, and hide the supporting processes from public view by removing them from the Drycc Workflow router.</p>
<h3 id="dns-service-discovery">DNS Service Discovery<a class="td-heading-self-link" href="#dns-service-discovery" aria-label="Heading self-link"></a></h3>
<p>Drycc Workflow supports deploying a single app composed of a system of processes. Each Drycc Workflow app communicates on a single port, so communicating with another Workflow app means finding that app&rsquo;s address and port. All Workflow apps are mapped to port 80 externally, so finding its IP address is the only challenge. Workflow creates a <a href="https://kubernetes.io/docs/user-guide/services/">Kubernetes Service</a> for each app, which effectively assigns a name and one cluster-internal IP address to an app. The DNS service running in the cluster adds and removes DNS records which point from the app name to its IP address as services are added and removed. Drycc Workflow apps, then, can simply send requests to the domain name given to the service, which is &ldquo;app-name.app-namespace&rdquo;.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3d9c4efe910f455454c4946b64225b5f">13 - Resource Limits</h1>
    <div class="lead">Drycc Workflow supports restricting memory and CPU shares of each process.</div>
	<h2 id="heading"><a class="td-heading-self-link" href="#heading" aria-label="Heading self-link"></a></h2>
<h2 id="managing-application-resource-limits">Managing Application Resource Limits<a class="td-heading-self-link" href="#managing-application-resource-limits" aria-label="Heading self-link"></a></h2>
<p>Drycc Workflow supports restricting memory and CPU shares of each process. Requests/Limits set on a per-process type are given to
Kubernetes as a requests and limits. Which means you guarantee &lt;requests&gt; amount of resource for a process as well as limit
the process from using more than &lt;limits&gt;.
By default, Kubernetes will set &lt;requests&gt; equal to &lt;limit&gt; if we don&rsquo;t explicitly set &lt;requests&gt; value. Please keep in mind that <code>0 &lt;= requests &lt;= limits</code>.</p>
<h2 id="limiting">Limiting<a class="td-heading-self-link" href="#limiting" aria-label="Heading self-link"></a></h2>
<p>If you set a requests/limits that is out of range for your cluster, Kubernetes will be unable to schedule your application
processes into the cluster!</p>
<pre tabindex="0"><code>$ drycc limits plans

ID                    SPEC    CPU              VCPUS    MEMORY     FEATURES                      
std1.large.c1m1       std1    Universal CPU    1        1 GiB      Integrated GPU shared    
std1.large.c1m2       std1    Universal CPU    1        2 GiB      Integrated GPU shared    
std1.large.c1m4       std1    Universal CPU    1        4 GiB      Integrated GPU shared    
std1.large.c1m8       std1    Universal CPU    1        8 GiB      Integrated GPU shared    
std1.large.c2m2       std1    Universal CPU    2        2 GiB      Integrated GPU shared    
std1.large.c2m4       std1    Universal CPU    2        4 GiB      Integrated GPU shared    
std1.large.c2m8       std1    Universal CPU    2        8 GiB      Integrated GPU shared    
std1.large.c2m16      std1    Universal CPU    2        16 GiB     Integrated GPU shared    

$ drycc limits set web=std1.large.c1m1
Applying limits... done
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-587aac9ca7fb3c0e091c5b73ec65588b">14 - Domains and Routing</h1>
    <div class="lead">Make your apps accessible via custom domain names.</div>
	<p>You can use <code>drycc domains</code> to add or remove custom domains to the application:</p>
<pre><code>$ drycc domains add hello.bacongobbler.com --ptype=web
Adding hello.bacongobbler.com to finest-woodshed... done
</code></pre>
<p>Once that&rsquo;s done, you can go into a DNS registrar and set up a CNAME from the new
appname to the old one:</p>
<pre><code>$ dig hello.dryccapp.com
[...]
;; ANSWER SECTION:
hello.bacongobbler.com.         1759    IN    CNAME    finest-woodshed.dryccapp.com.
finest-woodshed.dryccapp.com.    270     IN    A        172.17.8.100
</code></pre>
<p>!!! note
Setting a CNAME for a root domain can cause issues. Setting an @ record
to be a CNAME causes all traffic to go to the other domain, including mail and the SOA
(&ldquo;start-of-authority&rdquo;) records. It is highly recommended that you bind a subdomain to
an application, however you can work around this by pointing the @ record to the
address of the load balancer (if any).</p>
<p>To add or remove the application from the routing mesh, use <code>drycc routing</code>:</p>
<pre><code>$ drycc routing disable
Disabling routing for finest-woodshed... done
</code></pre>
<p>This will make the application unreachable through the <a href="/docs/understanding-workflow/components/#router">Router</a>, but the application is still
reachable internally through its <a href="../reference-guide/terms.md#service">Kubernetes Service</a>. To re-enable routing:</p>
<pre><code>$ drycc routing enable
Enabling routing for finest-woodshed... done
</code></pre>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ea3f4f0325f471c26fd2281464da7884">15 - Application SSL Certificates</h1>
    <div class="lead">SSL is a cryptographic protocol that provides end-to-end encryption and integrity for all web requests.</div>
	<h1 id="application-ssl-certificates">Application SSL Certificates<a class="td-heading-self-link" href="#application-ssl-certificates" aria-label="Heading self-link"></a></h1>
<p>SSL is a cryptographic protocol that provides end-to-end encryption and integrity for all web
requests. Apps that transmit sensitive data should enable SSL to ensure all information is
transmitted securely.</p>
<p>To enable SSL on a custom domain, e.g., <code>www.example.com</code>, use the SSL endpoint.</p>
<p>!!! note
<code>drycc certs</code> is only useful for custom domains. Default application domains are
SSL-enabled already and can be accessed simply by using https,
e.g. <code>https://foo.dryccapp.com</code> (provided that you have <a href="https://gateway-api.sigs.k8s.io/guides/tls/">installed your wildcard
certificate</a> on the routers or on the load balancer).</p>
<h2 id="overview">Overview<a class="td-heading-self-link" href="#overview" aria-label="Heading self-link"></a></h2>
<p>Because of the unique nature of SSL validation, provisioning SSL for your domain is a multi-step
process that involves several third-parties. You will need to:</p>
<ol>
<li>Purchase an SSL certificate from your SSL provider</li>
<li>Upload the cert to Drycc</li>
</ol>
<h2 id="acquire-ssl-certificate">Acquire SSL Certificate<a class="td-heading-self-link" href="#acquire-ssl-certificate" aria-label="Heading self-link"></a></h2>
<p>Purchasing an SSL cert varies in cost and process depending on the vendor. <a href="https://www.rapidssl.com/">RapidSSL</a> offers a
simple way to purchase a certificate and is a recommended solution. If you’re able to use this
provider, see <a href="https://www.rapidssl.com/buy-ssl/">buy an SSL certificate with RapidSSL</a> for instructions.</p>
<h2 id="dns-and-domain-configuration">DNS and Domain Configuration<a class="td-heading-self-link" href="#dns-and-domain-configuration" aria-label="Heading self-link"></a></h2>
<p>Once the SSL certificate is provisioned and your cert is confirmed, you must route requests for
your domain through Drycc. Unless you&rsquo;ve already done so, add the domain specified when generating
the CSR to your app with:</p>
<pre><code>$ drycc domains add www.example.com --ptype==web -a foo
Adding www.example.com to foo... done
</code></pre>
<h2 id="add-a-certificate">Add a Certificate<a class="td-heading-self-link" href="#add-a-certificate" aria-label="Heading self-link"></a></h2>
<p>Add your certificate, any intermediate certificates, and private key to the endpoint with the
<code>certs:add</code> command.</p>
<pre><code>$ drycc certs add example-com server.crt server.key -a foo
Adding SSL endpoint... done
www.example.com
</code></pre>
<p>!!! note
The name given to the certificate can only contain a-z (lowercase), 0-9 and hyphens</p>
<p>The Drycc platform will investigate the certificate and extract any relevant information from it
such as the Common Name, Subject Alt Names (SAN), fingerprint and more.</p>
<p>This allows for wildcard certificates and multiple domains in the SAN without uploading duplicates.</p>
<h3 id="add-a-certificate-chain">Add a Certificate Chain<a class="td-heading-self-link" href="#add-a-certificate-chain" aria-label="Heading self-link"></a></h3>
<p>Sometimes, your certificates (such as a self-signed or a cheap certificate) need additional
certificates to establish the chain of trust. What you need to do is bundle all the certificates
into one file and give that to Drycc. Importantly, your site’s certificate must be the first one:</p>
<pre><code>$ cat server.crt server.ca &gt; server.bundle
</code></pre>
<p>After that, you can add them to Drycc with the <code>certs add</code> command:</p>
<pre><code>$ drycc certs add example-com server.bundle server.key -a foo
Adding SSL endpoint... done
www.example.com
</code></pre>
<h2 id="attach-ssl-certificate-to-a-domain">Attach SSL certificate to a domain<a class="td-heading-self-link" href="#attach-ssl-certificate-to-a-domain" aria-label="Heading self-link"></a></h2>
<p>Certificates are not automagically connected up to domains, instead you will have to attach a
certificate to a domain</p>
<pre><code>$ drycc certs attach example-com example.com -a foo
</code></pre>
<p>Each certificate can be connected to many domains. There is no need to upload duplicates.</p>
<p>To remove an association</p>
<pre><code>$ drycc certs detach example-com example.com -a foo
</code></pre>
<h2 id="endpoint-overview">Endpoint overview<a class="td-heading-self-link" href="#endpoint-overview" aria-label="Heading self-link"></a></h2>
<p>You can verify the details of your domain&rsquo;s SSL configuration with <code>drycc certs</code>.</p>
<pre><code>$ drycc certs
NAME           COMMON-NAME    EXPIRES        SAN                 DOMAINS           
example-com    example.com    14 Jan 2017    blog.example.com    example.com
</code></pre>
<p>or by looking at at each certificates detailed information</p>
<pre><code>$ drycc certs info example-com -a foo

=== bar-com Certificate
Common Name(s):     example.com
Expires At:         2017-01-14 23:57:57 +0000 UTC
Starts At:          2016-01-15 23:57:57 +0000 UTC
Fingerprint:        7A:CA:B8:50:FF:8D:EB:03:3D:AC:AD:13:4F:EE:03:D5:5D:EB:5E:37:51:8C:E0:98:F8:1B:36:2B:20:83:0D:C0
Subject Alt Name:   blog.example.com
Issuer:             /C=US/ST=CA/L=San Francisco/O=Drycc/OU=Engineering/CN=example.com/emailAddress=engineering@drycc.cc
Subject:            /C=US/ST=CA/L=San Francisco/O=Drycc/OU=Engineering/CN=example.com/emailAddress=engineering@drycc.cc

Connected Domains:  example.com
Owner:              admin-user
Created:            2016-01-28 19:07:41 +0000 UTC
Updated:            2016-01-30 00:10:02 +0000 UTC
</code></pre>
<h2 id="testing-ssl">Testing SSL<a class="td-heading-self-link" href="#testing-ssl" aria-label="Heading self-link"></a></h2>
<p>Use a command line utility like <code>curl</code> to test that everything is configured correctly for your
secure domain.</p>
<p>!!! note
The -k option flag tells curl to ignore untrusted certificates.</p>
<p>Pay attention to the output. It should print <code>SSL certificate verify ok</code>. If it prints something
like <code>common name: www.example.com (does not match 'www.somedomain.com')</code> then something is not
configured correctly.</p>
<h2 id="enforcing-ssl-at-the-router">Enforcing SSL at the Router<a class="td-heading-self-link" href="#enforcing-ssl-at-the-router" aria-label="Heading self-link"></a></h2>
<p>To enforce all HTTP requests be redirected to HTTPS, TLS can be enforced at the router level by
running</p>
<pre><code>$ drycc tls force enable -a foo
Enabling https-only requests for foo... done
</code></pre>
<p>Users hitting the HTTP endpoint for the application will now receive a 301 redirect to the HTTPS
endpoint.</p>
<p>To disable enforced TLS, run</p>
<pre><code>$ drycc tls force disable -a foo
Disabling https-only requests for foo... done
</code></pre>
<h2 id="automated-certificate-management">Automated Certificate Management<a class="td-heading-self-link" href="#automated-certificate-management" aria-label="Heading self-link"></a></h2>
<p>With Automated Certificate Management (ACM), Drycc automatically manages TLS certificates for apps with Hobby and Professional dynos on the Common Runtime, and for apps in Private Spaces that enable the feature.
Certificates handled by ACM automatically renew one month before they expire, and new certificates are created automatically whenever you add or remove a custom domain. All applications with paid dynos include ACM for free.
Automated Certificate Management uses Let’s Encrypt, the free, automated, and open certificate authority for managing your application’s TLS certificates. Let’s Encrypt is run for the public benefit by the Internet Security Research Group (ISRG).</p>
<p>To enable ACM with the following command:
$ drycc tls auto enable -a foo</p>
<p>To disable ACM with the following command:
$ drycc tls auto disable -a foo</p>
<h2 id="remove-certificate">Remove Certificate<a class="td-heading-self-link" href="#remove-certificate" aria-label="Heading self-link"></a></h2>
<p>You can remove a certificate using the <code>certs:remove</code> command:</p>
<pre><code>$ drycc certs remove my-cert -a foo
Removing www.example.com... Done.
</code></pre>
<h2 id="swapping-out-certificates">Swapping out certificates<a class="td-heading-self-link" href="#swapping-out-certificates" aria-label="Heading self-link"></a></h2>
<p>Over the lifetime of an application an operator will have to acquire certificates with new expire
dates and apply it to all relevant applications, below is the recommended way to swap out certificates.</p>
<p>Be intentional with certificate names, name them <code>example-com-2017</code> when possible, where the year
signifies the expiry year. This allows for <code>example-com-2018</code> when a new certificate is purchased.</p>
<p>Assuming all applications are already using <code>example-com-2017</code> the following commands can be ran,
chained together or otherwise:</p>
<pre><code>$ drycc certs detach example-com-2017 example.com -a foo
$ drycc certs attach example-com-2018 example.com -a foo
</code></pre>
<p>This will take care of a singular domain which allows the operator to verify everything went
as planned and slowly roll it out to any other application using the same method.</p>
<h2 id="troubleshooting">Troubleshooting<a class="td-heading-self-link" href="#troubleshooting" aria-label="Heading self-link"></a></h2>
<p>Here are some steps you can follow if your SSL endpoint is not working as you&rsquo;d expect.</p>
<h3 id="untrusted-certificate">Untrusted Certificate<a class="td-heading-self-link" href="#untrusted-certificate" aria-label="Heading self-link"></a></h3>
<p>In some cases when accessing the SSL endpoint, it may list your certificate as untrusted.</p>
<p>If this occurs, it may be because it is not trusted by Mozilla’s list of <a href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/included/">root CAs</a>. If this is
the case, your certificate may be considered untrusted for many browsers.</p>
<p>If you have uploaded a certificate that was signed by a root authority but you get the message that
it is not trusted, then something is wrong with the certificate. For example, it may be missing
<a href="http://en.wikipedia.org/wiki/Intermediate_certificate_authorities">intermediary certificates</a>. If so, download the intermediary certificates from your SSL provider,
remove the certificate from Drycc and re-run the <code>certs add</code> command.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-25a98ad7024438acf828ac381152307f">16 - Using drycc path</h1>
    <div class="lead">Drycc Container Registry allows you to deploy your Docker-based app to Drycc. Both Common Runtime and Private Spaces are supported.</div>
	<p>The Drycc stack is intended for advanced use cases only. Unless you have a specific need for custom Docker images, we recommend using Drycc’s default buildpack-powered build system. It offers automatic base image security updates and language-specific optimizations. It also avoids the need to maintain a container Dockerfile.</p>
<h2 id="drycc-config-path-overview">Drycc config path overview<a class="td-heading-self-link" href="#drycc-config-path-overview" aria-label="Heading self-link"></a></h2>
<p>A drycc repository comes in two different flavours:</p>
<ul>
<li>
<p>a <code>.drycc</code> directory at the root of the working tree;</p>
</li>
<li>
<p>a root directory that is a &lsquo;bare&rsquo; repository(i.e. without its own working tree).
that is typically used for <code>drycc pull</code>.</p>
</li>
</ul>
<p>These things may exist in a drycc repository.</p>
<pre tabindex="0"><code>config/[a-z0-9]+(\.[a-z0-9]+)*::
        Configure file name, file name is group name.
        Format is environment variable format.

[a-z0-9]+(\-[a-z0-9]+)*.(yaml|yml)::
        Pipeline configure file.
</code></pre><h3 id="config-format">Config format<a class="td-heading-self-link" href="#config-format" aria-label="Heading self-link"></a></h3>
<p>Environment variables follow <NAME>=<VALUE> formatting. By convention, but not rule, environment variable names are always capitalized.</p>
<pre tabindex="0"><code>DEBUG=true
JVM_OPTIONS=-XX:+UseG1GC
</code></pre><h3 id="pipeline-format">Pipeline format<a class="td-heading-self-link" href="#pipeline-format" aria-label="Heading self-link"></a></h3>
<p>A manifest has three top-level sections.</p>
<ul>
<li>build – Specifies the to build Dockerfile.</li>
<li>env – Specifies environment variables in container.</li>
<li>run – Specifies the release phase tasks to execute.</li>
<li>config – Specifies config group, global group automatic reference.</li>
<li>deploy – Specifies the commands and args to deploy.</li>
</ul>
<p>Here’s an example that illustrates using a manifest to build Docker images.</p>
<pre tabindex="0"><code>kind: pipeline
ptype: web
build:
  docker: Dockerfile
  arg:
    CODENAME: bookworm
env:
  VERSION: 1.2.1
run:
  command:
  - ./deployment-tasks.sh
  image: task
  timeout: 100
config:
- jvm-config
deploy:
  command:
  - bash
  - -ec
  args:
  - bundle exec puma -C config/puma.rb
</code></pre><p>For more deployment information, please refer to the drycc <a href="https://github.com/drycc/samples">examples</a>.</p>

</div>



    
	
  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Tawk" aria-label="Tawk">
    <a target="_blank" rel="noopener" href="https://tawk.to/chat/6234b5491ffac05b1d7f4669/1fueu8a9t" aria-label="Tawk">
      <i class="fa fa-comment-dots"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Reddit" aria-label="Reddit">
    <a target="_blank" rel="noopener" href="https://www.reddit.com/r/drycc" aria-label="Reddit">
      <i class="fa-brands fa-reddit"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/drycc" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Slack" aria-label="Slack">
    <a target="_blank" rel="noopener" href="https://drycc.slack.com/" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2015&ndash;2025
    <span class="td-footer__authors">Drycc Authors | <a href="https://legal.doopai.com/#/cloud-services-terms">Terms of Service</a> | <a href="https://legal.doopai.com/#/doopai-cookie-policy">Cookies</a> |</span></span><span class="td-footer__all_rights_reserved">All Rights Reserved</span><span class="ms-2"><a href="https://legal.doopai.com/#/doopai-privacy-policy" target="_blank" rel="noopener">Privacy Policy</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.min.69e2c1ae9320465ab10236d9ef752c6a4442c54b48b883b17c497b7c7d96a796.js" integrity="sha256-aeLBrpMgRlqxAjbZ73UsakRCxUtIuIOxfEl7fH2Wp5Y=" crossorigin="anonymous"></script>
<script defer src="/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js" integrity="sha256-c0eKfUgHaYrtfjVesj&#43;YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>
